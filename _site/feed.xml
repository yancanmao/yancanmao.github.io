<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>MYC Blog</title>
    <description>Yancan Mao, a 2nd year Ph.D. Student in National University of Singapore</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Wed, 25 Nov 2020 20:47:59 +0800</pubDate>
    <lastBuildDate>Wed, 25 Nov 2020 20:47:59 +0800</lastBuildDate>
    <generator>Jekyll v3.9.0</generator>
    
      <item>
        <title>Internet Architecture</title>
        <description>&lt;h2 id=&quot;internet-architecture&quot;&gt;Internet Architecture&lt;/h2&gt;

&lt;h4 id=&quot;performance&quot;&gt;performance&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Network Performance Metrics&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Link Rate/Bandwidth/Capacity&lt;/p&gt;

&lt;p&gt;Throughput(successful message delivery)&lt;/p&gt;

&lt;p&gt;End-to-end delay&lt;/p&gt;

&lt;p&gt;Response time&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Packet switching versus circuit switching:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;circuit-switching 10 users. reserved resources&lt;/li&gt;
  &lt;li&gt;packet switching: 35 users. on-demand allocation&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Littleâ€™s Law: $L = \lambda W$&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Arrival rate: ğœ†&lt;/p&gt;

&lt;p&gt;# of customers/packets in the system: ğ¿&lt;/p&gt;

&lt;p&gt;Sojourn time ğ‘Š&lt;/p&gt;

&lt;h4 id=&quot;queueing&quot;&gt;Queueing&lt;/h4&gt;

&lt;p&gt;independent and identically distributed(i.i.d)&lt;/p&gt;

&lt;p&gt;random variable (r.v.)&lt;/p&gt;

&lt;p&gt;probability density function&lt;/p&gt;

&lt;p&gt;exponential distribution: $F(x) = P{T \le x} = 1 - e^{- \lambda x}$ or $F\overline (x) = P{T &amp;gt; x} = e^{- \lambda x}$&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Memoryless property: $P{T&amp;gt;s+t&lt;/td&gt;
      &lt;td&gt;T &amp;gt; s} = P{T&amp;gt;t}$&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;M/M/1 Model&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;percentage of time that the â€œserverâ€ is busy, probability a random observation finds server busy&lt;/p&gt;

&lt;p&gt;Utilization: $\rho = \frac{\lambda}{\mu}$&lt;/p&gt;

&lt;p&gt;Percentage of time that exactly $i$ packets or customer in the system, i.e., packets or customers in the system, i.e., server + queue.&lt;/p&gt;

&lt;p&gt;MM1 system: $\pi_{i} = P]{L=i}=\rho^i(1-\rho)$&lt;/p&gt;

&lt;p&gt;Average # of packet in the system: $E(L) = \frac{\rho}{1-\rho}$&lt;/p&gt;

&lt;p&gt;Average sojourn time of packets: $E(W) = \frac{1}{\mu - \lambda}$&lt;/p&gt;

&lt;p&gt;Average # of packets in the queue $E(Q) = \frac{\rho^2}{1-\rho}$&lt;/p&gt;

&lt;p&gt;Avg. queueing delay of packets $E(D) = E(W) - \frac{1}{\mu}$&lt;/p&gt;

&lt;p&gt;the joint probability: $P{L_1= j, L_2 = k} = P{L_1 = j}P{L_2 = k} = \rho_1^j(1-\rho)\rho_2^k(1-\rho_2)$&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Jackson Network&lt;/strong&gt;: $\lambda_i = r_i+\sum_{j=1}^{n} \lambda_j P_{ji}$&lt;/p&gt;

&lt;h4 id=&quot;resource-allocation&quot;&gt;Resource Allocation&lt;/h4&gt;

&lt;p&gt;reason: Internet provides best-effort service&lt;/p&gt;

&lt;p&gt;Solution: allocate different amount resource to different application flows.&lt;/p&gt;

&lt;p&gt;Fairness: Equal share of resources&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Max-Min Fairness&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Max-Min Fair: distributed mechanisms are needed.&lt;/p&gt;

&lt;p&gt;Generalized Process Sharing (GPS)&lt;/p&gt;

&lt;p&gt;Weighted Fair Queueing (WFQ): packet-based and work-conserving&lt;/p&gt;

&lt;p&gt;Virtual Departure Time&lt;/p&gt;

&lt;p&gt;virtual finish time&lt;/p&gt;

&lt;h4 id=&quot;software-defined-networking&quot;&gt;Software Defined Networking&lt;/h4&gt;

&lt;p&gt;network management&lt;/p&gt;

&lt;p&gt;networks are still notoriously hard to manage&lt;/p&gt;

&lt;p&gt;Data Plane: processing and delivery of packets&lt;/p&gt;

&lt;p&gt;Control Plane: establishing the state in routers&lt;/p&gt;

&lt;p&gt;Benefits of Separation:&lt;/p&gt;

&lt;p&gt;Independent evolution and development&lt;/p&gt;

&lt;p&gt;Control from high-level software program&lt;/p&gt;

&lt;p&gt;Benefits of Centralization:&lt;/p&gt;

&lt;p&gt;Centralized decisions are easier to make&lt;/p&gt;

&lt;p&gt;Logically vs. physically centralized: SDN logically centralized&lt;/p&gt;

&lt;p&gt;modularize the network control problem.&lt;/p&gt;

&lt;p&gt;network virtualization: SDN case study&lt;/p&gt;

&lt;h4 id=&quot;bgp&quot;&gt;BGP&lt;/h4&gt;

&lt;p&gt;AS: Autonomous System&lt;/p&gt;

&lt;p&gt;Link state algorithm: all routers have complete topology, link cost info, Open Shortest Path First (OSPF)&lt;/p&gt;

&lt;p&gt;Distance vector algorithm: router knows neighbors, link costs , Routing Information Protocol (RIP)&lt;/p&gt;

&lt;p&gt;Distance Vector (DV) approach&lt;/p&gt;

&lt;p&gt;Path-Vector(PV) Routing&lt;/p&gt;

&lt;p&gt;Border Gateway Protocol (BGP): the de facto inter-domain routing protocol&lt;/p&gt;
</description>
        <pubDate>Mon, 03 Dec 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/12/03/internet-architecture/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/12/03/internet-architecture/</guid>
        
        <category>å­¦ä¹ </category>
        
        <category>æŠ€æœ¯</category>
        
        
      </item>
    
      <item>
        <title>Distributed Database</title>
        <description>&lt;h2 id=&quot;distributed-database&quot;&gt;Distributed Database&lt;/h2&gt;

&lt;h4 id=&quot;distributed-database-design-fragmentation&quot;&gt;Distributed Database design: Fragmentation&lt;/h4&gt;

&lt;p&gt;Data fragmentation: Horizontal fragmentation, Vertical fragmentation, Hybrid fragmentation&lt;/p&gt;

&lt;h4 id=&quot;distributed-query-processing&quot;&gt;Distributed Query Processing&lt;/h4&gt;

&lt;p&gt;Join Strategies: Collocated Join(0), Directed Join(size(R)), Broadcast Join((n âˆ’ 1) Ã— size(R)), Repartitioned Join(size(R) + size(S))&lt;/p&gt;

&lt;h4 id=&quot;storage--indexing&quot;&gt;Storage &amp;amp; Indexing&lt;/h4&gt;

&lt;p&gt;LSM = Log-Structured Merge: Targeted at write-intensive workloads&lt;/p&gt;

&lt;p&gt;Compaction Strategies: Size-tiered Compaction Strategy (STCS)&lt;/p&gt;

&lt;p&gt;Leveled Compaction Strategy (LCS): F = compaction factor, Compact when $Size(L) &amp;gt; F^L$&lt;/p&gt;

&lt;p&gt;Optimizing SSTable Search: Sparse Index(find block in table), Bloom Filter(find key in block)&lt;/p&gt;

&lt;p&gt;Indexing: Local Indexing, Global Indexing&lt;/p&gt;

&lt;h4 id=&quot;distributed-commit-protocols&quot;&gt;Distributed Commit Protocols&lt;/h4&gt;

&lt;p&gt;ACID properties: Atomicity, Consistency, Isolation, Durability&lt;/p&gt;

&lt;p&gt;Xact failures, System failures, Media failures&lt;/p&gt;

&lt;p&gt;Transaction originating site ,Transaction coordinator (TC), Transaction Manager (TM)&lt;/p&gt;

&lt;p&gt;Commit protocol: 2PC, 3PC (Before sends messages, writes log records, reflect its state.)&lt;/p&gt;

&lt;p&gt;2PC: prepare(coordinator see global result), commit. (block)&lt;/p&gt;

&lt;p&gt;3PC: prepare, precommit(inform others global result), commit. (non-block)&lt;/p&gt;

&lt;p&gt;Recovery protocol: restarted servers do things.&lt;/p&gt;

&lt;p&gt;Termination protocol: timer runs out will invoke termination protocol(either abort or resend its msg)&lt;/p&gt;

&lt;p&gt;Cooperative Termination (CT) Protocol: coordinator fail, one P ask all other Ps for final state.&lt;/p&gt;

&lt;p&gt;New Coordinator Termination Protocol: a new coordinator, State-request message.&lt;/p&gt;

&lt;h4 id=&quot;distributed-concurrency-control&quot;&gt;Distributed Concurrency Control&lt;/h4&gt;

&lt;p&gt;view equivalent, view serializable schedule&lt;/p&gt;

&lt;p&gt;conflict equivalent, conflict serializable schedule $\to$ view serializable schedule&lt;/p&gt;

&lt;p&gt;Lock-Based Concurrency Control:&lt;/p&gt;

&lt;p&gt;Two Phase Locking (2PL) Protocol (conflict serializable)&lt;/p&gt;

&lt;p&gt;Strict Two Phase Locking (S2PL) (conflict serializable &amp;amp; recoverable)&lt;/p&gt;

&lt;p&gt;Multiversion Concurrency Control: not blocked&lt;/p&gt;

&lt;p&gt;multiversion view equivalent (S $\equiv_{mv}$ Sâ€²): have the same set of read-from relationships&lt;/p&gt;

&lt;p&gt;monoversion schedule: read most recently created version&lt;/p&gt;

&lt;p&gt;serial monoversion schedule: if it is a serial schedule&lt;/p&gt;

&lt;p&gt;multiversion view serializable schedule (MVSS): exists serial monoversion schedule&lt;/p&gt;

&lt;p&gt;view serializable schedule (VSS) $\to$ multiversion view serializable schedule
(MVSS)&lt;/p&gt;

&lt;p&gt;Snapshot isolation:&lt;/p&gt;

&lt;p&gt;Concurrent Update Property: First Committer Wins (FCW) Rule, First Updater Wins (FUW) Rule&lt;/p&gt;

&lt;p&gt;Serializable Snapshot Isolation (SSI) Protocol: Detects non-serializable schedules&lt;/p&gt;

&lt;p&gt;Concurrency Control Protocols:&lt;/p&gt;

&lt;p&gt;Distributed Lock-based Protocols: Centralized 2PL (C2PL), Distributed 2PL (D2PL)
Centralized Snapshot Isolation (CSI): Centralized Coordinator (CC)&lt;/p&gt;

&lt;h4 id=&quot;data-replication&quot;&gt;Data Replication&lt;/h4&gt;

&lt;p&gt;One-copy database = non-replicated database&lt;/p&gt;

&lt;p&gt;one-copy serializable (1SR): the same effect as executes on a one-copy database&lt;/p&gt;

&lt;p&gt;mutually consistency: all the replicas have the identical values, strong consis, weak consis.&lt;/p&gt;

&lt;p&gt;Replicated data (RD) schedules, One-copy (1C) schedules&lt;/p&gt;

&lt;p&gt;Statement-based replication: send updates to replicas&lt;/p&gt;

&lt;p&gt;Replication Protocols: Eager(Read-One-Write-All (ROWA) protocols), Lazy, Centralized, Distributed&lt;/p&gt;

&lt;p&gt;Lazy Distributed Protocol: Reconciliation of Inconsistent Updates: Last-Writer-Wins heuristic&lt;/p&gt;

&lt;h4 id=&quot;replicated-data-consistency&quot;&gt;Replicated Data Consistency&lt;/h4&gt;

&lt;p&gt;Consistent prefix and monotonic reads&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;C:\Users\Yancan\AppData\Roaming\Typora\typora-user-images\1543232060813.png&quot; alt=&quot;1543232060813&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;distributed-query-optimization&quot;&gt;Distributed Query Optimization&lt;/h4&gt;

&lt;p&gt;$Communication \ cost = T_{MSG}Ã— (number \ of \ messages) + T_{TR}Ã— (size \ of \ transferred \ data)$&lt;/p&gt;

&lt;p&gt;Selectivity Factors&lt;/p&gt;

&lt;p&gt;$SF_{SJ}(S.A) $= semijoin selectivity factor of S.A&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;$SF_{SJ}(S.A)  = \frac{card(Ï€A(S))}{&lt;/td&gt;
      &lt;td&gt;domain(A)&lt;/td&gt;
      &lt;td&gt;} $&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;SDD-1 Algorithm:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;For each relation, apply local reductions (i.e., selections, projections)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Iteratively select the most beneficial semijoin until none is applicable&lt;/li&gt;
  &lt;li&gt;Determine assembly site to compute joins&lt;/li&gt;
  &lt;li&gt;Post-optimization: eliminate unnecessary semijoin reductions&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;$card(Râ€²) = card(R) Ã— SF_{SJ} (S.A)$&lt;/p&gt;

&lt;p&gt;$size(Râ€²) = card(Râ€²) Ã— length(R)$&lt;/p&gt;

&lt;p&gt;Full Reducer, Ear Reduction&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;semijoin&lt;/td&gt;
      &lt;td&gt;cost&lt;/td&gt;
      &lt;td&gt;benefit&lt;/td&gt;
      &lt;td&gt;benefit-cost&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;relation X&lt;/td&gt;
      &lt;td&gt;size(X)	   attribute X.A&lt;/td&gt;
      &lt;td&gt;SF_sj(X.A)&lt;/td&gt;
      &lt;td&gt;size(\piA(X))&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</description>
        <pubDate>Tue, 27 Nov 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/11/27/distributed-database/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/11/27/distributed-database/</guid>
        
        <category>å­¦ä¹ </category>
        
        <category>æŠ€æœ¯</category>
        
        
      </item>
    
      <item>
        <title>Distributed System</title>
        <description>&lt;h2 id=&quot;distributed-system-skeleton&quot;&gt;Distributed System Skeleton&lt;/h2&gt;

&lt;h4 id=&quot;lecture2&quot;&gt;lecture2&lt;/h4&gt;

&lt;p&gt;OSI model&lt;/p&gt;

&lt;p&gt;RPC goal: Simple. non-blocking RPC&lt;/p&gt;

&lt;p&gt;MultiCast: Application-Level Multicast(p2p), IP Multicast&lt;/p&gt;

&lt;p&gt;Gossip: O(logn) Gossip aggregation: sum, average, minâ€¦ O(logn)&lt;/p&gt;

&lt;h4 id=&quot;lecture3&quot;&gt;lecture3&lt;/h4&gt;

&lt;p&gt;Processes are expensive: creation cost, context switch, inter-process communication(all of them will involve OS) â€“ same app no need isolation.&lt;/p&gt;

&lt;p&gt;Threads are cheap: three aspect not via OS. user-level threads, kernel-level threads, LWP. block problem(non-blocking, upcall).&lt;/p&gt;

&lt;p&gt;Thread pool: used in Dist sys, pre request a pool of threads, dispatch threads for incoming jobs, optimize thread creation cost, more stable against perk load.&lt;/p&gt;

&lt;p&gt;Event driven Architecture: problem: single Thread maintain all CPU state information of each request.&lt;/p&gt;

&lt;p&gt;Event driven: highly specialized thread package, every request has its own thread package, no need to maintain other requestsâ€™ CPU state, context switch will faster.&lt;/p&gt;

&lt;p&gt;stateful-stateless: try to be stateless.&lt;/p&gt;

&lt;p&gt;Server Cluster: tier architecture.&lt;/p&gt;

&lt;h4 id=&quot;lecture4&quot;&gt;lecture4&lt;/h4&gt;

&lt;p&gt;Name System: Merge name spaces: new root node, mounting.&lt;/p&gt;

&lt;p&gt;Simple Naming: resolve a name: broad cast, forwarding pointers, home-based approach.&lt;/p&gt;

&lt;p&gt;DNS.&lt;/p&gt;

&lt;h4 id=&quot;lecture5&quot;&gt;lecture5&lt;/h4&gt;

&lt;p&gt;Physical Clock sync motivation: Clock rate drift, clock drift&lt;/p&gt;

&lt;p&gt;Physical clock sync solve problem: clock drift&lt;/p&gt;

&lt;p&gt;Cristianâ€™s protocol assumption: same request and reply delay.&lt;/p&gt;

&lt;p&gt;Network Time protocol: sync with multiple servers, pick smallest d. delay minimum. server need UTC&lt;/p&gt;

&lt;p&gt;The Berkeley alg: no accurate time all servers.&lt;/p&gt;

&lt;p&gt;Software clock: no external clocks. infer ordering of events.&lt;/p&gt;

&lt;p&gt;Software clock assumption: atomic is important.&lt;/p&gt;

&lt;p&gt;logical clock: clock 1 &amp;lt; 5 !=&amp;gt; event 1 happens before 5.&lt;/p&gt;

&lt;p&gt;vector clock: clock 1 &amp;lt; 5 =&amp;gt; event 1 happens before 5.&lt;/p&gt;

&lt;p&gt;mutual exclusion: guarantee atomic? lock manager election&lt;/p&gt;

&lt;p&gt;Token based approach: use a leader server&lt;/p&gt;

&lt;p&gt;Voting: quorum vote to get lock&lt;/p&gt;

&lt;p&gt;Leader Election:&lt;/p&gt;

&lt;h4 id=&quot;lecture6&quot;&gt;lecture6&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Consistency model:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Sequential consistency: all processors execute in the same order, sequence may not the same with global time order.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;linearizability consistency: sequential consistency and time follow global time.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Eventual consistency: all replica will eventually be the same, so as we see, final state should be the same.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Continuous Consistency: one model named TACT, eventual consistency always be ensured&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;final image of continuous consistency: numerical error, order error, temporal error.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Consistency protocol:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;linearizability/sequential consistency protocol:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;primary-based protocol: all request handled by primary, backup just replicate and read. read once write all.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;app uses primary-based protocol: Software Distributed Shared Memory&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;failure dealing of primary-based protocol: lease of replica, backup kill itself if no leases.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Replicated State Machine Protocol: read/write majority. instruction of each node should be the same.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Eventual Consistency protocol:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The Anti-entropy protocol: write/read all, instructions execute in every node, apply cmd in the same order is important.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;keep cmds the same order: logical clock, happen-before, Committed and Tentative Write.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;how to find committed and tentative write: use a sequencer to identify. (A,2,1)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Continuous Consistency protocol:(only detection, and alg I assume it is black box)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Temporal Error TACT: real-time vector clock, compute TE according to curtime - vetor x_i&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Numerical Error TACT: has a global NE stats server to compute the total NE.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Order Error TACT: number of Tentative write is Order Error, detect and use normal alg to solve it.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Replica Replacement: NP hard, global view of info.&lt;/p&gt;

&lt;h4 id=&quot;lecture7&quot;&gt;lecture7&lt;/h4&gt;

&lt;p&gt;Nodes Failure model&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Crash Failure&lt;/li&gt;
  &lt;li&gt;Byzantine Failure&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Communication channels failure: no failure or unreliable(drop msg)&lt;/p&gt;

&lt;p&gt;Timing model&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Sync model: msg delay is bounded, node speed guarantee, accurate failure detection.&lt;/li&gt;
  &lt;li&gt;Async model: msg delay is not bounded, node speed is not guarantee.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Distributed Consensus: failure-free: vote, xact commit, write ordering.&lt;/p&gt;

&lt;p&gt;under failure: Node Crash/Byzantine, channels unreliable, sync/async.&lt;/p&gt;

&lt;p&gt;termination, agreement&lt;/p&gt;

&lt;h4 id=&quot;lecture8&quot;&gt;lecture8&lt;/h4&gt;

&lt;p&gt;p2p:&lt;/p&gt;

&lt;p&gt;unstructured file sharing: central directory server, super-peers, flooding flat p2p topology, random walks flat p2p topology.&lt;/p&gt;

&lt;p&gt;structured file sharing: DHT&lt;/p&gt;
</description>
        <pubDate>Thu, 15 Nov 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/11/15/distributed-system/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/11/15/distributed-system/</guid>
        
        <category>å­¦ä¹ </category>
        
        <category>æŠ€æœ¯</category>
        
        
      </item>
    
      <item>
        <title>JavaçŸ¥è¯†æ¬è¿</title>
        <description>&lt;h2 id=&quot;æ³›å‹&quot;&gt;æ³›å‹&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/95f349258afb&quot;&gt;https://www.jianshu.com/p/95f349258afb&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ï¼Ÿ&lt;/strong&gt; è¡¨ç¤ºä¸ç¡®å®šçš„javaç±»å‹&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;T (type)&lt;/strong&gt; è¡¨ç¤ºå…·ä½“çš„ä¸€ä¸ªjavaç±»å‹&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;K V (key value)&lt;/strong&gt; åˆ†åˆ«ä»£è¡¨javaé”®å€¼ä¸­çš„Key Value&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;E (element)&lt;/strong&gt; ä»£è¡¨Element&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;static-å…³é”®å­—&quot;&gt;static å…³é”®å­—&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/dolphin0520/p/3799052.html&quot;&gt;https://www.cnblogs.com/dolphin0520/p/3799052.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ¨ã€ŠJavaç¼–ç¨‹æ€æƒ³ã€‹P86é¡µæœ‰è¿™æ ·ä¸€æ®µè¯ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;â€œstaticæ–¹æ³•å°±æ˜¯æ²¡æœ‰thisçš„æ–¹æ³•ã€‚åœ¨staticæ–¹æ³•å†…éƒ¨ä¸èƒ½è°ƒç”¨éé™æ€æ–¹æ³•ï¼Œåè¿‡æ¥æ˜¯å¯ä»¥çš„ã€‚è€Œä¸”å¯ä»¥åœ¨æ²¡æœ‰åˆ›å»ºä»»ä½•å¯¹è±¡çš„å‰æä¸‹ï¼Œä»…ä»…é€šè¿‡ç±»æœ¬èº«æ¥è°ƒç”¨staticæ–¹æ³•ã€‚è¿™å®é™…ä¸Šæ­£æ˜¯staticæ–¹æ³•çš„ä¸»è¦ç”¨é€”ã€‚â€&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç®€è¨€ä¹‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;staticçš„ç”¨å¤„å°±æ˜¯æ–¹ä¾¿åœ¨æ²¡æœ‰åˆ›å»ºå¯¹è±¡çš„æƒ…å†µä¸‹æ¥è¿›è¡Œè°ƒç”¨ï¼ˆæ–¹æ³•/å˜é‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¢«staticå…³é”®å­—ä¿®é¥°çš„æ–¹æ³•æˆ–è€…å˜é‡ä¸éœ€è¦ä¾èµ–äºå¯¹è±¡æ¥è¿›è¡Œè®¿é—®ï¼Œåªè¦ç±»è¢«åŠ è½½äº†ï¼Œå°±å¯ä»¥é€šè¿‡ç±»åå»è¿›è¡Œè®¿é—®ã€‚&lt;/p&gt;

&lt;p&gt;staticå¯ä»¥ç”¨æ¥ä¿®é¥°ç±»çš„æˆå‘˜æ–¹æ³•ã€ç±»çš„æˆå‘˜å˜é‡ï¼Œå¦å¤–å¯ä»¥ç¼–å†™staticä»£ç å—æ¥&lt;strong&gt;ä¼˜åŒ–ç¨‹åºæ€§èƒ½&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ³¨æ„ç‚¹&quot;&gt;æ³¨æ„ç‚¹&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é™æ€&lt;/strong&gt;æ–¹æ³•ä¸­&lt;strong&gt;ä¸èƒ½&lt;/strong&gt;è®¿é—®&lt;strong&gt;éé™æ€&lt;/strong&gt;æˆå‘˜æ–¹æ³•å’Œéé™æ€æˆå‘˜å˜é‡ï¼Œ &lt;strong&gt;éé™æ€&lt;/strong&gt;æˆå‘˜æ–¹æ³•ä¸­æ˜¯&lt;strong&gt;å¯ä»¥è®¿é—®&lt;/strong&gt;é™æ€æˆå‘˜æ–¹æ³•/å˜é‡&lt;/li&gt;
  &lt;li&gt;é™æ€å˜é‡è¢«æ‰€æœ‰çš„å¯¹è±¡æ‰€å…±äº«ï¼Œå†…å­˜ä¸­åªæœ‰ä¸€ä¸ªå‰¯æœ¬ï¼Œå½“ä¸”ä»…å½“åœ¨ç±»åˆæ¬¡åŠ è½½æ—¶ä¼šè¢«åˆå§‹åŒ–ã€‚&lt;/li&gt;
  &lt;li&gt;æ¯”è¾ƒå…³é”®çš„ä½œç”¨ï¼Œç”¨æ¥å½¢æˆé™æ€ä»£ç å—ä»¥ä¼˜åŒ–ç¨‹åºæ€§èƒ½ï¼Œå¾ˆå¤šæ—¶å€™ä¼šå°†ä¸€äº›åªéœ€è¦è¿›è¡Œä¸€æ¬¡çš„åˆå§‹åŒ–æ“ä½œéƒ½æ”¾åœ¨staticä»£ç å—ä¸­è¿›è¡Œã€‚(è¿™ä¸ªå°±å…·ä½“çš„æƒ…å†µå…·ä½“çš„å®ç°å§ï¼Œç›®å‰æ¥è¯´éƒ½æ˜¯è·Ÿç€éœ€æ±‚èµ°çš„)&lt;/li&gt;
  &lt;li&gt;staticå…³é”®å­—å¹¶ä¸ä¼šæ”¹å˜å˜é‡å’Œæ–¹æ³•çš„è®¿é—®æƒé™ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;final-å…³é”®å­—&quot;&gt;final å…³é”®å­—&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/dolphin0520/p/3736238.html&quot;&gt;https://www.cnblogs.com/dolphin0520/p/3736238.html&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä½œç”¨&quot;&gt;ä½œç”¨&lt;/h3&gt;

&lt;h4 id=&quot;1-ä¿®é¥°ç±»è¡¨æ˜è¿™ä¸ªç±»ä¸èƒ½è¢«ç»§æ‰¿&quot;&gt;1. ä¿®é¥°ç±»ï¼šè¡¨æ˜è¿™ä¸ªç±»ä¸èƒ½è¢«ç»§æ‰¿ã€‚&lt;/h4&gt;

&lt;p&gt;åœ¨ä½¿ç”¨finalä¿®é¥°ç±»çš„æ—¶å€™ï¼Œè¦æ³¨æ„è°¨æ…é€‰æ‹©ï¼Œé™¤éè¿™ä¸ªç±»çœŸçš„åœ¨ä»¥åä¸ä¼šç”¨æ¥ç»§æ‰¿æˆ–è€…å‡ºäºå®‰å…¨çš„è€ƒè™‘ï¼Œå°½é‡ä¸è¦å°†ç±»è®¾è®¡ä¸ºfinalç±»ã€‚&lt;/p&gt;

&lt;h4 id=&quot;2-ä¿®é¥°æ–¹æ³•&quot;&gt;2. ä¿®é¥°æ–¹æ³•&lt;/h4&gt;

&lt;p&gt;ä¸‹é¢è¿™æ®µè¯æ‘˜è‡ªã€ŠJavaç¼–ç¨‹æ€æƒ³ã€‹ç¬¬å››ç‰ˆç¬¬143é¡µï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;â€œä½¿ç”¨finalæ–¹æ³•çš„åŸå› æœ‰ä¸¤ä¸ªã€‚ç¬¬ä¸€ä¸ªåŸå› æ˜¯æŠŠæ–¹æ³•é”å®šï¼Œä»¥é˜²ä»»ä½•ç»§æ‰¿ç±»ä¿®æ”¹å®ƒçš„å«ä¹‰ï¼›ç¬¬äºŒä¸ªåŸå› æ˜¯æ•ˆç‡ã€‚åœ¨æ—©æœŸçš„Javaå®ç°ç‰ˆæœ¬ä¸­ï¼Œä¼šå°†finalæ–¹æ³•è½¬ä¸ºå†…åµŒè°ƒç”¨ã€‚ä½†æ˜¯å¦‚æœæ–¹æ³•è¿‡äºåºå¤§ï¼Œå¯èƒ½çœ‹ä¸åˆ°å†…åµŒè°ƒç”¨å¸¦æ¥çš„ä»»ä½•æ€§èƒ½æå‡ã€‚åœ¨æœ€è¿‘çš„Javaç‰ˆæœ¬ä¸­ï¼Œ&lt;strong&gt;ä¸éœ€è¦&lt;/strong&gt;ä½¿ç”¨finalæ–¹æ³•è¿›è¡Œè¿™äº›ä¼˜åŒ–äº†ã€‚â€œ&lt;/li&gt;
  &lt;li&gt;ç±»çš„privateæ–¹æ³•ä¼šéšå¼åœ°è¢«æŒ‡å®šä¸ºfinalæ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;3-ä¿®é¥°å˜é‡ä¿®é¥°å˜é‡æ˜¯finalç”¨å¾—æœ€å¤šçš„åœ°æ–¹&quot;&gt;3. ä¿®é¥°å˜é‡ï¼šä¿®é¥°å˜é‡æ˜¯finalç”¨å¾—æœ€å¤šçš„åœ°æ–¹&lt;/h4&gt;

&lt;p&gt;å¯¹äºä¸€ä¸ªfinalå˜é‡ï¼Œå¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œåˆ™å…¶æ•°å€¼ä¸€æ—¦åœ¨åˆå§‹åŒ–ä¹‹åä¾¿ä¸èƒ½æ›´æ”¹ï¼›å¦‚æœæ˜¯å¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œåˆ™åœ¨å¯¹å…¶åˆå§‹åŒ–ä¹‹åä¾¿ä¸èƒ½å†è®©å…¶æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ã€‚&lt;/p&gt;

&lt;h2 id=&quot;java-å…³é”®å­—&quot;&gt;Java å…³é”®å­—&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/AloneZ/p/java1.html&quot;&gt;https://www.cnblogs.com/AloneZ/p/java1.html&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ç±»æ–¹æ³•å’Œå˜é‡ä¿®é¥°ç¬¦&quot;&gt;ç±»ã€æ–¹æ³•å’Œå˜é‡ä¿®é¥°ç¬¦&lt;/h3&gt;

&lt;h4 id=&quot;1-abstract-å£°æ˜æŠ½è±¡&quot;&gt;1) abstract å£°æ˜æŠ½è±¡&lt;/h4&gt;

&lt;p&gt;abstractå…³é”®å­—å¯ä»¥ä¿®æ”¹ç±»æˆ–æ–¹æ³•ã€‚abstractç±»å¯ä»¥æ‰©å±•ï¼ˆå¢åŠ å­ç±»ï¼‰ï¼Œä½†ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ã€‚abstractæ–¹æ³•ä¸åœ¨å£°æ˜å®ƒçš„ç±»ä¸­å®ç°ï¼Œä½†å¿…é¡»åœ¨æŸä¸ªå­ç±»ä¸­é‡å†™ã€‚é‡‡ç”¨ abstractæ–¹æ³•çš„ç±»æœ¬æ¥å°±æ˜¯æŠ½è±¡ç±»ï¼Œå¹¶ä¸”å¿…é¡»å£°æ˜ä¸ºabstractã€‚&lt;/p&gt;

&lt;h4 id=&quot;2-classç±»&quot;&gt;2) classç±»&lt;/h4&gt;

&lt;p&gt;class å…³é”®å­—ç”¨æ¥å£°æ˜æ–°çš„ &lt;a href=&quot;http://lib.csdn.net/base/javase&quot;&gt;Java&lt;/a&gt; ç±»ï¼Œè¯¥ç±»æ˜¯ç›¸å…³å˜é‡å’Œ/æˆ–æ–¹æ³•çš„é›†åˆã€‚ç±»æ˜¯é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡æ–¹æ³•çš„åŸºæœ¬æ„é€ å•ä½ã€‚ç±»é€šå¸¸ä»£è¡¨æŸç§å®é™…å®ä½“ï¼Œå¦‚å‡ ä½•å½¢çŠ¶æˆ–äººã€‚ç±»æ˜¯å¯¹è±¡çš„æ¨¡æ¿ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚è¦ä½¿ç”¨ç±»ï¼Œé€šå¸¸ä½¿ç”¨ new æ“ä½œç¬¦å°†ç±»çš„å¯¹è±¡å®ä¾‹åŒ–ï¼Œç„¶åè°ƒç”¨ç±»çš„æ–¹æ³•æ¥è®¿é—®ç±»çš„åŠŸèƒ½ã€‚&lt;/p&gt;

&lt;h4 id=&quot;3-extends-ç»§æ‰¿æ‰©å±•&quot;&gt;3) extends ç»§æ‰¿ã€æ‰©å±•&lt;/h4&gt;

&lt;p&gt;extends å…³é”®å­—ç”¨åœ¨ class æˆ– interface å£°æ˜ä¸­ï¼Œç”¨äºæŒ‡ç¤ºæ‰€å£°æ˜çš„ç±»æˆ–æ¥å£æ˜¯å…¶åç§°åè·Ÿæœ‰ extends å…³é”®å­—çš„ç±»æˆ–æ¥å£çš„å­ç±»ã€‚å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰ public å’Œ protected å˜é‡å’Œæ–¹æ³•ã€‚ å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„ä»»ä½•é final æ–¹æ³•ã€‚ä¸€ä¸ªç±»åªèƒ½æ‰©å±•ä¸€ä¸ªå…¶ä»–ç±»ã€‚&lt;/p&gt;

&lt;h4 id=&quot;4-final-æœ€ç»ˆä¸å¯æ”¹å˜&quot;&gt;4) final æœ€ç»ˆã€ä¸å¯æ”¹å˜&lt;/h4&gt;

&lt;p&gt;final å…³é”®å­—å¯ä»¥åº”ç”¨äºç±»ï¼Œä»¥æŒ‡ç¤ºä¸èƒ½æ‰©å±•è¯¥ç±»ï¼ˆä¸èƒ½æœ‰å­ç±»ï¼‰ã€‚final å…³é”®å­—å¯ä»¥åº”ç”¨äºæ–¹æ³•ï¼Œä»¥æŒ‡ç¤ºåœ¨å­ç±»ä¸­ä¸èƒ½é‡å†™æ­¤æ–¹æ³•ã€‚ä¸€ä¸ªç±»ä¸èƒ½åŒæ—¶æ˜¯ abstract åˆæ˜¯ finalã€‚abstract æ„å‘³ç€å¿…é¡»æ‰©å±•ç±»ï¼Œfinal æ„å‘³ç€ä¸èƒ½æ‰©å±•ç±»ã€‚ä¸€ä¸ªæ–¹æ³•ä¸èƒ½åŒæ—¶æ˜¯ abstract åˆæ˜¯ finalã€‚abstract æ„å‘³ç€å¿…é¡»é‡å†™æ–¹æ³•ï¼Œfinal æ„å‘³ç€ä¸èƒ½é‡å†™æ–¹æ³•ã€‚&lt;/p&gt;

&lt;h4 id=&quot;5-implementså®ç°&quot;&gt;5) implementså®ç°&lt;/h4&gt;

&lt;p&gt;implements å…³é”®å­—åœ¨ class å£°æ˜ä¸­ä½¿ç”¨ï¼Œä»¥æŒ‡ç¤ºæ‰€å£°æ˜çš„ç±»æä¾›äº†åœ¨ implements å…³é”®å­—åé¢çš„åç§°æ‰€æŒ‡å®šçš„æ¥å£ä¸­æ‰€å£°æ˜çš„æ‰€æœ‰æ–¹æ³•çš„å®ç°ã€‚ç±»å¿…é¡»æä¾›åœ¨æ¥å£ä¸­æ‰€å£°æ˜çš„æ‰€æœ‰æ–¹æ³•çš„å®ç°ã€‚ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚&lt;/p&gt;

&lt;h4 id=&quot;6-interface-æ¥å£&quot;&gt;6) interface æ¥å£&lt;/h4&gt;

&lt;p&gt;interface å…³é”®å­—ç”¨æ¥å£°æ˜æ–°çš„ Java æ¥å£ï¼Œæ¥å£æ˜¯æ–¹æ³•çš„é›†åˆã€‚&lt;/p&gt;

&lt;p&gt;æ¥å£æ˜¯ Java è¯­è¨€çš„ä¸€é¡¹å¼ºå¤§åŠŸèƒ½ã€‚ä»»ä½•ç±»éƒ½å¯å£°æ˜å®ƒå®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ï¼Œè¿™æ„å‘³ç€å®ƒå®ç°äº†åœ¨è¿™äº›æ¥å£ä¸­æ‰€å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•ã€‚&lt;/p&gt;

&lt;p&gt;å®ç°äº†æ¥å£çš„ä»»ä½•ç±»éƒ½å¿…é¡»æä¾›åœ¨è¯¥æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•çš„å®ç°ã€‚ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚&lt;/p&gt;

&lt;h4 id=&quot;7-native-æœ¬åœ°&quot;&gt;7) native æœ¬åœ°&lt;/h4&gt;

&lt;p&gt;native å…³é”®å­—å¯ä»¥åº”ç”¨äºæ–¹æ³•ï¼Œä»¥æŒ‡ç¤ºè¯¥æ–¹æ³•æ˜¯ç”¨ Java ä»¥å¤–çš„è¯­è¨€å®ç°çš„ã€‚&lt;/p&gt;

&lt;h4 id=&quot;8-new-æ–°åˆ›å»º&quot;&gt;8) new æ–°,åˆ›å»º&lt;/h4&gt;

&lt;p&gt;new å…³é”®å­—ç”¨äºåˆ›å»ºç±»çš„æ–°å®ä¾‹ã€‚&lt;/p&gt;

&lt;p&gt;new å…³é”®å­—åé¢çš„å‚æ•°å¿…é¡»æ˜¯ç±»åï¼Œå¹¶ä¸”ç±»åçš„åé¢å¿…é¡»æ˜¯ä¸€ç»„æ„é€ æ–¹æ³•å‚æ•°ï¼ˆå¿…é¡»å¸¦æ‹¬å·ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;å‚æ•°é›†åˆå¿…é¡»ä¸ç±»çš„æ„é€ æ–¹æ³•çš„ç­¾ååŒ¹é…ã€‚&lt;/p&gt;

&lt;p&gt;= å·¦ä¾§çš„å˜é‡çš„ç±»å‹å¿…é¡»ä¸è¦å®ä¾‹åŒ–çš„ç±»æˆ–æ¥å£å…·æœ‰èµ‹å€¼å…¼å®¹å…³ç³»ã€‚&lt;/p&gt;

&lt;h4 id=&quot;9-static-é™æ€&quot;&gt;9) static é™æ€&lt;/h4&gt;

&lt;p&gt;static å…³é”®å­—å¯ä»¥åº”ç”¨äºå†…éƒ¨ç±»ï¼ˆåœ¨å¦ä¸€ä¸ªç±»ä¸­å®šä¹‰çš„ç±»ï¼‰ã€æ–¹æ³•æˆ–å­—æ®µï¼ˆç±»çš„æˆå‘˜å˜é‡ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;é€šå¸¸ï¼Œstatic å…³é”®å­—æ„å‘³ç€åº”ç”¨å®ƒçš„å®ä½“åœ¨å£°æ˜è¯¥å®ä½“çš„ç±»çš„ä»»ä½•ç‰¹å®šå®ä¾‹å¤–éƒ¨å¯ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;staticï¼ˆå†…éƒ¨ï¼‰ç±»å¯ä»¥è¢«å…¶ä»–ç±»å®ä¾‹åŒ–å’Œå¼•ç”¨ï¼ˆå³ä½¿å®ƒæ˜¯é¡¶çº§ç±»ï¼‰ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¦ä¸€ä¸ªç±»ä¸­çš„ä»£ç å¯ä»¥å®ä¾‹åŒ– MyStaticClass ç±»ï¼Œæ–¹æ³•æ˜¯ç”¨åŒ…å«å®ƒçš„ç±»åæ¥é™å®šå…¶åç§°ï¼Œå¦‚ MyClass.MyStaticClassã€‚&lt;/p&gt;

&lt;p&gt;static å­—æ®µï¼ˆç±»çš„æˆå‘˜å˜é‡ï¼‰åœ¨ç±»çš„æ‰€æœ‰å®ä¾‹ä¸­åªå­˜åœ¨ä¸€æ¬¡ã€‚&lt;/p&gt;

&lt;p&gt;å¯ä»¥ä»ç±»çš„å¤–éƒ¨è°ƒç”¨ static æ–¹æ³•ï¼Œè€Œä¸ç”¨é¦–å…ˆå®ä¾‹åŒ–è¯¥ç±»ã€‚è¿™æ ·çš„å¼•ç”¨å§‹ç»ˆåŒ…æ‹¬ç±»åä½œä¸ºæ–¹æ³•è°ƒç”¨çš„é™å®šç¬¦ã€‚&lt;/p&gt;

&lt;p&gt;æ¨¡å¼ï¼špublic final static &lt;type&gt; varName = &lt;value&gt;; é€šå¸¸ç”¨äºå£°æ˜å¯ä»¥åœ¨ç±»çš„å¤–éƒ¨ä½¿ç”¨çš„ç±»å¸¸é‡ã€‚åœ¨å¼•ç”¨è¿™æ ·çš„ç±»å¸¸é‡æ—¶éœ€è¦ç”¨ç±»ååŠ ä»¥é™å®šã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¦ä¸€ä¸ªç±»å¯ä»¥ç”¨ MyClass.MAX_OBJECTS å½¢å¼æ¥å¼•ç”¨ MAX_OBJECTS å¸¸é‡ã€‚&lt;/value&gt;&lt;/type&gt;&lt;/p&gt;

&lt;h4 id=&quot;10-strictfp-ä¸¥æ ¼ç²¾å‡†&quot;&gt;10) strictfp ä¸¥æ ¼,ç²¾å‡†&lt;/h4&gt;

&lt;p&gt;strictfpçš„æ„æ€æ˜¯FP-strictï¼Œä¹Ÿå°±æ˜¯è¯´ç²¾ç¡®æµ®ç‚¹çš„æ„æ€ã€‚åœ¨Javaè™šæ‹Ÿæœºè¿›è¡Œæµ®ç‚¹è¿ç®—æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šstrictfpå…³é”®å­—æ—¶ï¼ŒJavaçš„ç¼–è¯‘å™¨ä»¥åŠè¿è¡Œç¯å¢ƒåœ¨å¯¹æµ®ç‚¹è¿ç®—çš„è¡¨è¾¾å¼æ˜¯é‡‡å–ä¸€ç§è¿‘ä¼¼äºæˆ‘è¡Œæˆ‘ç´ çš„è¡Œä¸ºæ¥å®Œæˆè¿™äº›æ“ä½œï¼Œä»¥è‡´äºå¾—åˆ°çš„ç»“æœå¾€å¾€æ— æ³•ä»¤äººæ»¡æ„ã€‚è€Œä¸€æ—¦ä½¿ç”¨äº†strictfpæ¥å£°æ˜ä¸€ä¸ªç±»ã€æ¥å£æˆ–è€…æ–¹æ³•æ—¶ï¼Œé‚£ä¹ˆæ‰€å£°æ˜çš„èŒƒå›´å†…Javaçš„ç¼–è¯‘å™¨ä»¥åŠè¿è¡Œç¯å¢ƒä¼šå®Œå…¨ä¾ç…§æµ®ç‚¹è§„èŒƒIEEE-754æ¥æ‰§è¡Œã€‚å› æ­¤å¦‚æœæƒ³è®©æµ®ç‚¹è¿ç®—æ›´åŠ ç²¾ç¡®ï¼Œè€Œä¸”ä¸ä¼šå› ä¸ºä¸åŒçš„ç¡¬ä»¶å¹³å°æ‰€æ‰§è¡Œçš„ç»“æœä¸ä¸€è‡´çš„è¯ï¼Œé‚£å°±è¯·ç”¨å…³é”®å­—strictfpã€‚&lt;/p&gt;

&lt;p&gt;å¯ä»¥å°†ä¸€ä¸ªç±»ã€æ¥å£ä»¥åŠæ–¹æ³•å£°æ˜ä¸ºstrictfpï¼Œä½†æ˜¯ä¸å…è®¸å¯¹æ¥å£ä¸­çš„æ–¹æ³•ä»¥åŠæ„é€ å‡½æ•°å£°æ˜strictfpå…³é”®å­—&lt;/p&gt;

&lt;h4 id=&quot;11-synchronizedçº¿ç¨‹åŒæ­¥&quot;&gt;11) synchronizedçº¿ç¨‹ã€åŒæ­¥&lt;/h4&gt;

&lt;p&gt;synchronized å…³é”®å­—å¯ä»¥åº”ç”¨äºæ–¹æ³•æˆ–è¯­å¥å—ï¼Œå¹¶ä¸ºä¸€æ¬¡åªåº”ç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„å…³é”®ä»£ç æ®µæä¾›ä¿æŠ¤ã€‚&lt;/p&gt;

&lt;p&gt;synchronized å…³é”®å­—å¯é˜²æ­¢ä»£ç çš„å…³é”®ä»£ç æ®µä¸€æ¬¡è¢«å¤šä¸ªçº¿ç¨‹æ‰§è¡Œã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœåº”ç”¨äºé™æ€æ–¹æ³•ï¼Œé‚£ä¹ˆï¼Œå½“è¯¥æ–¹æ³•ä¸€æ¬¡ç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œæ•´ä¸ªç±»å°†è¢«é”å®šã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœåº”ç”¨äºå®ä¾‹æ–¹æ³•ï¼Œé‚£ä¹ˆï¼Œå½“è¯¥æ–¹æ³•ä¸€æ¬¡ç”±ä¸€ä¸ªçº¿ç¨‹è®¿é—®æ—¶ï¼Œè¯¥å®ä¾‹å°†è¢«é”å®šã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœåº”ç”¨äºå¯¹è±¡æˆ–æ•°ç»„ï¼Œå½“å…³è”çš„ä»£ç å—ä¸€æ¬¡ç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œå¯¹è±¡æˆ–æ•°ç»„å°†è¢«é”å®šã€‚&lt;/p&gt;

&lt;h4 id=&quot;12-transient-çŸ­æš‚&quot;&gt;12) transient çŸ­æš‚&lt;/h4&gt;

&lt;p&gt;transient å…³é”®å­—å¯ä»¥åº”ç”¨äºç±»çš„æˆå‘˜å˜é‡ï¼Œä»¥ä¾¿æŒ‡å‡ºè¯¥æˆå‘˜å˜é‡ä¸åº”åœ¨åŒ…å«å®ƒçš„ç±»å®ä¾‹å·²åºåˆ—åŒ–æ—¶è¢«åºåˆ—åŒ–ã€‚&lt;/p&gt;

&lt;p&gt;å½“ä¸€ä¸ªå¯¹è±¡è¢«ä¸²è¡ŒåŒ–çš„æ—¶å€™ï¼Œtransientå‹å˜é‡çš„å€¼ä¸åŒ…æ‹¬åœ¨ä¸²è¡ŒåŒ–çš„è¡¨ç¤ºä¸­ï¼Œç„¶è€Œétransientå‹çš„å˜é‡æ˜¯è¢«åŒ…æ‹¬è¿›å»çš„ã€‚&lt;/p&gt;

&lt;p&gt;Javaçš„serializationæä¾›äº†ä¸€ç§æŒä¹…åŒ–å¯¹è±¡å®ä¾‹çš„æœºåˆ¶ã€‚å½“æŒä¹…åŒ–å¯¹è±¡æ—¶ï¼Œå¯èƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡æ•°æ®æˆå‘˜ï¼Œæˆ‘ä»¬ä¸æƒ³ç”¨serializationæœºåˆ¶æ¥ä¿å­˜å®ƒã€‚ä¸ºäº†åœ¨ä¸€ä¸ªç‰¹å®šå¯¹è±¡çš„ä¸€ä¸ªåŸŸä¸Šå…³é—­serializationï¼Œå¯ä»¥åœ¨è¿™ä¸ªåŸŸå‰åŠ ä¸Šå…³é”®å­—transientã€‚
     transientæ˜¯Javaè¯­è¨€çš„å…³é”®å­—ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªåŸŸä¸æ˜¯è¯¥å¯¹è±¡ä¸²è¡ŒåŒ–çš„ä¸€éƒ¨åˆ†ã€‚å½“ä¸€ä¸ªå¯¹è±¡è¢«ä¸²è¡ŒåŒ–çš„æ—¶å€™ï¼Œtransientå‹å˜é‡çš„å€¼ä¸åŒ…æ‹¬åœ¨ä¸²è¡ŒåŒ–çš„è¡¨ç¤ºä¸­ï¼Œç„¶è€Œétransientå‹çš„å˜é‡æ˜¯è¢«åŒ…æ‹¬è¿›å»çš„ã€‚&lt;/p&gt;

&lt;h4 id=&quot;13-volatile-æ˜“å¤±&quot;&gt;13) volatile æ˜“å¤±&lt;/h4&gt;

&lt;p&gt;volatile å…³é”®å­—ç”¨äºè¡¨ç¤ºå¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å¼‚æ­¥ä¿®æ”¹çš„æˆå‘˜å˜é‡ã€‚&lt;/p&gt;

&lt;p&gt;æ³¨æ„ï¼švolatile å…³é”®å­—åœ¨è®¸å¤š Java è™šæ‹Ÿæœºä¸­éƒ½æ²¡æœ‰å®ç°ã€‚ volatile çš„ç›®æ ‡ç”¨é€”æ˜¯ä¸ºäº†ç¡®ä¿æ‰€æœ‰çº¿ç¨‹æ‰€çœ‹åˆ°çš„æŒ‡å®šå˜é‡çš„å€¼éƒ½æ˜¯ç›¸åŒçš„ã€‚&lt;/p&gt;

&lt;p&gt;Java è¯­è¨€ä¸­çš„ volatile å˜é‡å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ç§ â€œç¨‹åº¦è¾ƒè½»çš„ synchronizedâ€ï¼›ä¸ synchronized å—ç›¸æ¯”ï¼Œvolatile å˜é‡æ‰€éœ€çš„ç¼–ç è¾ƒå°‘ï¼Œå¹¶ä¸”è¿è¡Œæ—¶å¼€é”€ä¹Ÿè¾ƒå°‘ï¼Œä½†æ˜¯å®ƒæ‰€èƒ½å®ç°çš„åŠŸèƒ½ä¹Ÿä»…æ˜¯ synchronized çš„ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
</description>
        <pubDate>Mon, 09 Jul 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/07/09/java%E7%9F%A5%E8%AF%86%E6%90%AC%E8%BF%90/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/07/09/java%E7%9F%A5%E8%AF%86%E6%90%AC%E8%BF%90/</guid>
        
        
      </item>
    
      <item>
        <title>Yarnå­¦ä¹ ç¬”è®°</title>
        <description>&lt;h2 id=&quot;yarnå­¦ä¹ ç¬”è®°&quot;&gt;YARNå­¦ä¹ ç¬”è®°&lt;/h2&gt;

&lt;h3 id=&quot;introduction&quot;&gt;Introduction&lt;/h3&gt;

&lt;p&gt;æœ¬æ¬¡å­¦ä¹ ç¬”è®°å€Ÿé‰´Hadoop YARNæƒå¨æŒ‡å—ä¹¦ç±ï¼Œè¿›è¡Œè¾ƒä¸ºæœ‰ç›®çš„çš„é˜…è¯»ï¼Œæœ€åå°†è‡ªå·±æ‰€æƒ³äº†è§£çš„å†…å®¹è®°å½•äºç¬”è®°ä¸­ä»¥ä¾›åç»­çš„å­¦ä¹ ã€‚&lt;/p&gt;

&lt;h4 id=&quot;yarnå†å²&quot;&gt;YARNå†å²&lt;/h4&gt;

&lt;h5 id=&quot;ad-hocé›†ç¾¤&quot;&gt;Ad Hocé›†ç¾¤&lt;/h5&gt;

&lt;p&gt;ç±»ä¼¼äºå¤šå°ä¸»æœºä¸Šè¿è¡Œçš„æ¡Œé¢åº”ç”¨ï¼Œæ„Ÿè§‰ä¸Šå¯èƒ½æ˜¯å¤šå°æœºå™¨ä¸Šæ‰‹åŠ¨è¿›è¡Œåº”ç”¨è¿è¡Œï¼Œä½†æ˜¯æœºå™¨ä¹‹é—´çš„æ–‡ä»¶ä¸å…±äº«ã€‚&lt;/p&gt;

&lt;h5 id=&quot;hod&quot;&gt;HOD&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;åŠ å…¥è°ƒåº¦å™¨ResourceManager&lt;/li&gt;
  &lt;li&gt;å’ŒRMäº¤äº’çš„å¤šä¸ªç»„ä»¶&lt;/li&gt;
  &lt;li&gt;MRä»¥åŠHDFSå®ˆæŠ¤è¿›ç¨‹&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¼˜ç‚¹ï¼šå¯å¤šç”¨æˆ·å¤šé›†ç¾¤çš„è¿è¡Œï¼Œåˆ©ç”¨ç‡æ›´é«˜ï¼Œè®¾è®¡æ›´åˆç†&lt;/p&gt;

&lt;p&gt;ç¼ºç‚¹ï¼šä¸çŸ¥é“HDFSçš„æ–‡ä»¶åˆ†å¸ƒï¼Œåˆ†é…èŠ‚ç‚¹æ—¶ä¸èƒ½è€ƒè™‘HDFSçš„æ–‡ä»¶å’Œåº”ç”¨åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šå—ï¼Œä»è€Œå¢å¤§ç½‘ç»œå¼€é”€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/39119611.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;å…±äº«é›†ç¾¤&quot;&gt;å…±äº«é›†ç¾¤&lt;/h5&gt;

&lt;p&gt;ä¸»è¦ç»„ä»¶ï¼š&lt;/p&gt;

&lt;p&gt;JobTrackerï¼Œå¯ä»¥ç®¡ç†æ•´ä¸ªé›†ç¾¤çš„jobï¼Œæœ‰ç‚¹ç±»ä¼¼YARNä¸­çš„AppMasterï¼Œä½†æ˜¯AppMasteråªç®¡ç†ä¸€ä¸ªjobã€‚&lt;/p&gt;

&lt;p&gt;TaskTrackerï¼Œæ¥å—Jobtrackerçš„å‘½ä»¤ç„¶åæ‰§è¡Œï¼Œå¯ä»¥è¿è¡Œæ‰€æœ‰çš„ä½œä¸šã€‚&lt;/p&gt;

&lt;h5 id=&quot;yarn&quot;&gt;YARN&lt;/h5&gt;

&lt;p&gt;è¦æ±‚ï¼šå¯æ‹“å±•æ€§ï¼Œå¯ç»´æŒè¡Œï¼Œå¤šç”¨æˆ·ï¼Œä½ç½®æ„ŸçŸ¥ï¼Œé›†ç¾¤é«˜ä½¿ç”¨ç‡ï¼Œå®‰å…¨ï¼Œç¼–ç¨‹æ¨¡å‹å¤šæ ·æ€§ï¼Œå‘åå…¼å®¹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/152392.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;yarnè®¾è®¡ç»†èŠ‚&quot;&gt;YARNè®¾è®¡ç»†èŠ‚&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;YARNç›®å‰çš„è®¾è®¡æ˜¯ä¸ºäº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶ä»»åŠ¡ï¼Œè®¾è®¡ä¸€ä¸ªApplicationMasteræ§åˆ¶æ¯ä¸ªjobï¼Œéš”ç¦»æ¯ä¸ªåº”ç”¨çš„èµ„æºåˆ†é…ã€‚&lt;/li&gt;
  &lt;li&gt;containeræ˜¯ä¸€ç§èµ„æºåˆ†é…æ–¹å¼ï¼Œç§Ÿçº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;YARNç»„ä»¶ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ResourceManagerï¼šä¸»èŠ‚ç‚¹ï¼Œè´Ÿè´£è°ƒåº¦ï¼Œä¹Ÿå¯ä»¥æ¢å¤ApplicationMasterçš„çŠ¶æ€ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;YARNè°ƒåº¦ç»„ä»¶ï¼šä¸€ä¸ªå¯æ’æ‹”çš„è°ƒåº¦å™¨ï¼ŒFIFOï¼Œcapasityï¼ŒFair Shareã€‚ä¸»è¦é’ˆå¯¹å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—çš„è°ƒåº¦ï¼Œåœ¨å¤šç”¨æˆ·çš„ä»»åŠ¡è°ƒåº¦ä¸­å¾ˆæœ‰ç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;containerï¼šæ˜¯æ‰€æœ‰ç¡¬ä»¶èµ„æºçš„é›†åˆã€‚&lt;/li&gt;
  &lt;li&gt;NodeManagerï¼šè¿è¡ŒJobçš„taskå®ä¾‹ã€‚&lt;/li&gt;
  &lt;li&gt;ApplicationMasterï¼šåè°ƒappçš„è¿›ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;YARNæ¶æ„&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;p&gt;ç¬¬ä¸€ä»£çš„Hadoopæ˜¯åº”ç”¨å¹³å°ä¸åˆ†ç¦»çš„ï¼Œç¬¬äºŒä»£åˆ†ç¦»å‡ºäº†åº”ç”¨ï¼Œä½¿ç”¨ApplicationMasterç®¡ç†åº”ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/38612004.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ResourceManageråŠŸèƒ½&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/17294017.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;å®¢æˆ·ç«¯ä¸RMäº¤äº’ï¼šåº”ç”¨ç¨‹åºæäº¤ï¼Œåº”ç”¨ç¨‹åºç»ˆæ­¢ï¼Œè·å–åº”ç”¨ç¨‹åºï¼Œé˜Ÿåˆ—ï¼Œé›†ç¾¤ç»Ÿè®¡ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;åº”ç”¨ç¨‹åºä¸RMé€šä¿¡ï¼šæ³¨å†Œæ–°èŠ‚ç‚¹ï¼Œæ¥å—NMçš„å¿ƒè·³ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ ¸å¿ƒç»„ä»¶ï¼š&lt;/p&gt;

    &lt;p&gt;ApplicationManagerï¼šè´Ÿè´£ç®¡ç†å·²æäº¤åº”ç”¨ç¨‹åºçš„é›†åˆã€‚&lt;/p&gt;

    &lt;p&gt;ApplicationMaster Launcherï¼šå¯åŠ¨å„åº”ç”¨çš„ApplicationMasterã€‚&lt;/p&gt;

    &lt;p&gt;YarnSchedulerï¼šè´Ÿè´£ç»™æ­£åœ¨è¿è¡Œçš„è¿ç”¨ç¨‹åºåˆ†é…èµ„æºã€‚&lt;/p&gt;

    &lt;p&gt;ContainerAllocationExpirerï¼šå°†å¯¹å·²åˆ†é…ä½†æ˜¯æœªä½¿ç”¨çš„containerè¿›è¡Œè¿‡æœŸå›æ”¶ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;NodeManager&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è´Ÿè´£containerç®¡ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/73622478.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Container Launch Context(CLC)ï¼šæè¿°containerã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ä¸»è¦åŠŸèƒ½ï¼š&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;containerå¯åŠ¨ï¼š&lt;/strong&gt;åˆ›å»ºèµ„æºçš„å‰¯æœ¬ã€‚åˆ›å»ºç‹¬ç«‹çš„å·¥ä½œç›®å½•ã€‚å¯åŠ¨containerçš„ç¯å¢ƒå’Œå‘½ä»¤è¡Œã€‚&lt;/p&gt;

    &lt;p&gt;ç”¨æˆ·æ—¥å¿—ç®¡ç†åŠèšé›†ã€‚&lt;/p&gt;

    &lt;p&gt;MapReduce Shuffleè¾…åŠ©æœåŠ¡ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ ¸å¿ƒç»„ä»¶ï¼š&lt;/p&gt;

    &lt;p&gt;NodeStatusUpdaterï¼šå®šæœŸå‘RMå‘é€èŠ‚ç‚¹å¯ç”¨èµ„æºã€‚&lt;/p&gt;

    &lt;p&gt;ContainerManagerï¼šæ ¸å¿ƒç»„ä»¶ï¼Œç®¡ç†containerï¼ŒåŒ…å«RPC serverå’Œèµ„æºæœ¬åœ°åŒ–æœåŠ¡ã€‚&lt;/p&gt;

    &lt;p&gt;RPC Serverï¼šContainerManageræ¥å—AMå¯åŠ¨æ–°çš„containeræˆ–åœæ­¢containerè¯·æ±‚ã€‚&lt;/p&gt;

    &lt;p&gt;èµ„æºæœ¬åœ°åŒ–æœåŠ¡ï¼šè´Ÿè´£å®‰å…¨çš„ä¸‹è½½å’Œç»„ç»‡containeræ‰€éœ€çš„å„ç§æ–‡ä»¶èµ„æºã€‚å°½å¯èƒ½å°†æ–‡ä»¶åˆ†æ•£åˆ°å„ä¸ªå¯ç”¨ç£ç›˜ã€‚&lt;/p&gt;

    &lt;p&gt;Containers Monitorï¼šç›‘æ§containerçš„èµ„æºä½¿ç”¨æƒ…å†µã€‚&lt;/p&gt;

    &lt;p&gt;Log Handlerï¼šå¯æ’æ‹”ç»„ä»¶ï¼Œä¿å­˜æ—¥å¿—åˆ°æœ¬åœ°ã€‚&lt;/p&gt;

    &lt;p&gt;Container Executorï¼šä¸åº•å±‚æ“ä½œç³»ç»Ÿäº¤äº’ï¼Œå®‰å…¨é˜²æ”¾ç½®containeræ‰€éœ€è¦çš„æ–‡ä»¶å’Œç›®å½•ã€‚&lt;/p&gt;

    &lt;p&gt;Node Health Checker Serviceï¼šå¯¹èŠ‚ç‚¹çš„å¥åº·æƒ…å†µè¿›è¡Œæ£€æŸ¥ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;ApplicationMaster&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;p&gt;æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªJobTrackerã€‚&lt;/p&gt;

&lt;h4 id=&quot;ç»¼åˆç¬”è®°&quot;&gt;ç»¼åˆç¬”è®°&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;å¯ä»¥ä½¿ç”¨çš„Hadoopç®¡ç†å·¥å…·ï¼šAmbari&lt;/li&gt;
  &lt;li&gt;hadoopé›†ç¾¤çš„ç»Ÿä¸€æ“ä½œå‘½ä»¤ï¼špdsh&lt;/li&gt;
  &lt;li&gt;å®æ—¶ç›‘æ§ç³»ç»Ÿï¼šGanglia&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Thu, 21 Jun 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/06/21/YARN%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/06/21/YARN%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        
      </item>
    
      <item>
        <title>Ngneæ€»ç»“</title>
        <description>&lt;h2 id=&quot;ngneæ€»ç»“&quot;&gt;NGNEæ€»ç»“&lt;/h2&gt;

&lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;åœ¨è¿™è¾¹å†æ—¶123å¤©ï¼Œç»ˆäºæ˜¯å°†æ•´ä¸ªNGNEé¡¹ç›®èµ°å®Œäº†ï¼Œç°åœ¨æ„Ÿè§‰æå¦‚æ˜¨æ—¥æ‰åˆšæ¥è¿™è¾¹ã€‚è¿™ä¹ˆ4ä¸ªæœˆä»¥æ¥ï¼Œä¹Ÿç®—æ˜¯é™ä¸‹å¿ƒæ¥ï¼Œç€æ‰‹äºstreaming dataå’Œè¯¾ç¨‹ï¼Œè™½ç„¶è¯´æ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹èŠ‚å¥æ…¢ï¼Œæ•ˆç‡ä½çš„å«Œç–‘ã€‚ä¸è¿‡æ€»çš„æ¥è¯´è¿˜æ˜¯è®©äººæ¯”è¾ƒæ»¡æ„çš„çŠ¶æ€ã€‚åŸºæœ¬æ²¡æœ‰æ€ä¹ˆæ”¾æ¾è­¦æƒ•ï¼Œè¿˜æ˜¯æŒºå¥½çš„ï¼Œåº¦è¿‡äº†æœ€è‰°éš¾çš„ä¸€æ®µæ—¶é—´ï¼Œè¿™æ®µæ—¶é—´å°±å¥½å¥½çš„æ€»ç»“ä¸€ä¸‹è¿™æ®µæ—¶é—´çš„å¾—å¤±ã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ­£æ–‡&quot;&gt;æ­£æ–‡&lt;/h3&gt;

&lt;p&gt;è¿™æ®µæ—¶é—´ï¼Œä»ä¸€æœˆå®šä¸‹æ¥å¼€å§‹ï¼Œå°±çŸ¥é“æ˜¯ä¸€æ¬¡ä¸å®¹æ˜“çš„è¡Œç¨‹ï¼Œå½“ç„¶æœ€åçš„ç»“æœç¡®å®è¯å®äº†è¿™æ¬¡é¡¹ç›®çš„ä¸å®¹æ˜“ï¼Œä¸æ˜¯ä½“ç°åœ¨å·¥ä½œé‡ä¸Šé¢ï¼Œè€Œæ˜¯ä½“ç°åœ¨å¿ƒç†å‹åŠ›ï¼Œæ¯•ç«Ÿæœ‰ä¸€ä¸ªéœ€è¦è¾¾åˆ°çš„ç›®æ ‡ï¼Œè¿™ä¸ªç›®æ ‡æ‰å¼€å§‹æ„Ÿè§‰æ˜¯å®¹æ˜“è¾¾åˆ°çš„ï¼Œä½†æ˜¯åœ¨çœŸå®ä½“ä¼šä¸­ï¼Œåˆæ˜¯å¦ä¸€ç•ªåœºæ™¯ï¼Œä¸Šè¯¾å’Œsummer campçš„èŠ‚å¥å®Œå…¨ä¸ä¸€æ ·ï¼Œå†…å®¹ä¹Ÿæœ‰æ‰€å˜åŒ–ï¼Œprojectè¿˜å¥½ï¼Œåœ¨å¤šæ¬¡äº¤æµä»¥åŠå¯¹projectç†Ÿæ‚‰ä»¥åï¼Œå¯¹äºSamzaçš„å¼€å‘æ•ˆæœè¿˜æ˜¯å¾ˆå¥½ï¼Œèƒ½å¤Ÿæ¯”è¾ƒçµæ´»çš„è¿ç”¨Samzaã€‚è¯¾ç¨‹å…¨æ˜¯è‹±è¯­ï¼Œä¸å¾—ä¸è¯´è¿™å­¦æœŸè¯¾ç¨‹ä¸ŠçœŸçš„ç®—æ˜¯æ¯”è¾ƒå¤±è´¥çš„ï¼Œæ²¡æœ‰ä¸€èŠ‚è¯¾æ˜¯åœ¨ä¸Šè¯¾çš„æ—¶å€™ææ¸…æ¥šçš„åŸºæœ¬éƒ½æ˜¯åœ¨ä¸‹è¯¾åè¦ä¹ˆè‡ªå·±çœ‹slidesè¦ä¹ˆæ˜¯çœ‹web castï¼Œè™½ç„¶æœ€åçš„ç»“æœæ˜¯åŸºæœ¬æŒæ¡äº†è€å¸ˆä¸Šè¯¾è®²çš„ä¸œè¥¿ï¼Œä½†æ˜¯æ•ˆç‡ä¸é«˜ï¼Œæ²¡æœ‰åšåˆ°é™ä½æ—¶é—´çš„èŠ±é”€ã€‚&lt;/p&gt;

&lt;p&gt;ä¸è¿‡å…·ä½“å­¦åˆ°çš„ä¸œè¥¿è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œäººç”Ÿè·¯ä¸Šï¼Œè¿™æ ·ä¸€ä¸ª4ä¸ªæœˆçš„æˆé•¿è¿˜æ˜¯æŒºå¤§çš„ï¼Œä¸è¿‡ç”±äºæ²¡æœ‰æ¥è§¦åˆ°å…·ä½“çš„å¤§é¡¹ç›®ï¼Œå¯¹äºconcreteçš„ä¸€äº›ä¸œè¥¿çœ‹çš„ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œå…·ä½“å­¦ä¹ çš„ä¸œè¥¿æœ‰ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;YARNåˆ†å¸ƒå¼ä»»åŠ¡åˆ†é…ç³»ç»Ÿ&lt;/li&gt;
  &lt;li&gt;HDFSåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ&lt;/li&gt;
  &lt;li&gt;Samzaåˆ†å¸ƒå¼æµå¤„ç†ç³»ç»Ÿ&lt;/li&gt;
  &lt;li&gt;Sparkåˆ†å¸ƒå¼æµ\æ‰¹å¤„ç†ç³»ç»Ÿ&lt;/li&gt;
  &lt;li&gt;Kafkaåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘å¯¹ä¸Šè¿°çš„å‡ ä¸ªç³»ç»Ÿçš„ç†è§£éƒ½åŠ æ·±äº†ä¸€å±‚ï¼ŒåŠ ä¸Šå’Œå­¦é•¿ä¸€èµ·çœ‹äº†Samzaæºç ï¼Œå¯¹äºSamzaçš„ç†è§£æ›´æ·±äº†ï¼Œç°åœ¨å¯¹äºSamzaçš„ç†è§£ç›¸å½“äºæ˜¯ç«™åœ¨äº†high levelçš„è§†è§’çœ‹é—®é¢˜ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½æ›´åŠ çš„é€å½»ã€‚ç›®å‰è€Œè¨€è¿˜æ˜¯æ²¡æœ‰æ›´åŠ è¯¦ç»†è¯»å®Œæ•´ä¸ªSamzaçš„æºç ï¼Œæ‰€ä»¥å¾ˆå¤šäº‹æƒ…è¿˜æ˜¯æœ‰å¾…æé«˜çš„ï¼Œéœ€è¦å¤šçœ‹ï¼Œè‡³å°‘æŠŠéœ€è¦å¼„æ‡‚çš„é‚£éƒ¨åˆ†æºç çœ‹å®Œï¼Œæ¯”å¦‚è¯´standaloneæ¨¡å¼ã€‚è¿™éƒ¨åˆ†æ˜¯éå¸¸å¿…è¦çš„ï¼Œä¹‹å‰ä¸€æ®µæ—¶é—´æ˜¯ç€æ‰‹äºè€ƒè¯•çš„äº‹æƒ…ï¼Œè¿™æ®µæ—¶é—´æ²¡æœ‰äº‹æƒ…äº†ï¼Œé‚£ä¹ˆæœ‰å¾ˆå¤šæ—¶é—´å¯ä»¥è¿›è¡ŒåŸºç¡€çš„å·©å›ºï¼Œå¯ä»¥æ·±å…¥ç ”ç©¶ï¼Œè¿™ä¸ªé˜¶æ®µæ˜¯éå¸¸ç‰¹æ®Šçš„ï¼Œè¿˜æ˜¯è¦å‘è€å¸ˆå±•ç¤ºæˆ‘çš„çƒ­æƒ…ï¼Œæˆ‘çš„ä¸»è§‚èƒ½åŠ¨æ€§ã€‚&lt;/p&gt;

&lt;p&gt;è¯¾ç¨‹ä¸Šï¼Œå­¦ä¹ äº†è®¡ç®—æœºå®‰å…¨å’Œæœºå™¨å­¦ä¹ ï¼Œè¿™ä¸¤é—¨è¯¾å†…å®¹éƒ½æŒºå¥½çš„ï¼Œä½†æ˜¯éš¾å—çš„æ˜¯å¯¹æˆ‘æ¥è¯´å¾ˆå¤šéƒ½å¬ä¸æ‡‚ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºè‹±è¯­å¬åŠ›è–„å¼±ï¼Œä¸€æ–¹é¢æ˜¯å†…å®¹éœ€è¦å¥½å¥½å•ƒï¼Œä½†æ˜¯åœ¨è¿™æ—¶é—´é‡Œé¢ï¼Œæˆ‘è¿˜æ˜¯æµªè´¹äº†å¾ˆå¤šçš„æ—¶é—´ï¼Œç‰¹åˆ«æ˜¯ä¸Šè¯¾æ—¶é—´ï¼Œå®è´µçš„æ—¶é—´å¯èƒ½å¤§éƒ¨åˆ†æ²¡æœ‰å¬æ‡‚å°±è¿›å…¥äº†å‘å‘†çŠ¶æ€ï¼Œè¿™ç§çŠ¶æ€éœ€è¦ä¸¥æ ¼æœç»ï¼Œå…¶å®æ²¡æœ‰ä»»ä½•çš„ç†ç”±ä¸è®¤çœŸçš„ï¼Œåªæ˜¯æœ‰æ—¶å€™å¬ç´¯äº†ï¼Œæ²¡æœ‰ä»”ç»†ï¼Œè®¤çœŸçš„é”»ç‚¼è‡ªå·±çš„å£è¯­ï¼Œå¬åŠ›ï¼Œé˜…è¯»ï¼Œæ˜¯æˆ‘è¿™æ®µæ—¶é—´çš„è´¥ç¬”ï¼Œè¿™ç‚¹ä¸Šé¢æˆ‘éœ€è¦å¥½å¥½çš„æ£€è®¨ä¸€ä¸‹è‡ªå·±ï¼Œæ¯•ç«Ÿå¦‚æœæƒ³åœ¨è¿™è¾¹ç«‹è¶³ï¼Œè‹±è¯­å£è¯­ã€å¬åŠ›ã€é˜…è¯»æ˜¯å¿…é¡»è¿‡å…³çš„ï¼Œä¸ç®¡æ€ä¹ˆè¯´éƒ½éœ€è¦å¼ºåˆ¶è‡ªå·±å»ç»ƒä¹ ï¼Œåªæœ‰é€šè¿‡ä¸æ–­çš„ç»ƒä¹ æ‰èƒ½ä¸æ–­çš„è¿›æ­¥ã€‚&lt;/p&gt;

&lt;p&gt;æ€»çš„è¯´æ¥å¯èƒ½è¿˜æ˜¯ç›¸å¯¹ç®€å•ï¼Œå°±æ˜¯åšäº†ä¸€ä¸ªprojectï¼ˆæ¯”è¾ƒç®€å•ï¼‰ï¼Œç„¶åå­¦äº†ä¸¤é—¨è¯¾ï¼Œåœ¨è¿™è¾¹æœ€å¤§çš„æ”¶è·æ˜¯é¢†ç•¥äº†ä¸€ç•ªå­¦æœ¯ç•Œçš„é£é‡‡ï¼ŒçŸ¥é“å­¦æœ¯ç•Œçš„å…·ä½“å·¥ä½œè¿˜æ˜¯æŒºä¸å®¹æ˜“çš„ï¼ŒçŸ¥é“äº†ç§‘ç ”çš„äººéƒ½åœ¨åšä»€ä¹ˆï¼Œå…¶å®åšsystemç¡®å®éå¸¸çš„è‰°éš¾ï¼Œéœ€è¦è‡ªå·±å»æ‰¾æ–¹å‘ï¼Œè¿™å¯¹äºä¸€ä¸ªæ²¡æœ‰ä»»ä½•ç§¯ç´¯çš„äººæ¥è¯´æ˜¯ä¸€ä¸ªæå¤§çš„æŒ‘æˆ˜ï¼Œæ‰€ä»¥æœ‰æ—¶å€™éœ€è¦æ…¢ä¸‹æ¥ï¼Œè¿™æ®µæ—¶é—´æ—å¬äº†é‚£ä¹ˆä¹…çš„å­¦é•¿ä»¬çš„ä¼šè®®ï¼Œå¯¹ä»–ä»¬çš„ä¸œè¥¿ä¹Ÿæœ‰äº†å¤§è‡´çš„äº†è§£ï¼Œæˆ‘è§‰å¾—ç¡®å®è¿˜æ˜¯æŒºæœ‰æ”¶è·ï¼Œå¯¹äºå¼€æºé¡¹ç›®ï¼Œå¼€æºå·¥å…·çš„åŸç†ã€æºç çš„é˜…è¯»è®©æˆ‘ä»¥åçŸ¥é“äº†å¦‚ä½•å¯¹ä¸€ä¸ªæœªçŸ¥çš„ä¸œè¥¿è¿›è¡Œå¤„ç†ï¼Œå°±ç®—æ˜¯documentçœ‹ä¸æ‡‚ï¼Œä¹Ÿæœ‰æºç å¯ä»¥é˜…è¯»ï¼Œä¸åªæ˜¯çœ‹APIçš„æºç ï¼Œä¹Ÿå¯ä»¥çœ‹æ ¸å¿ƒä»£ç ï¼Œçœ‹çœ‹å‚æ•°ä¼ é€’ï¼Œçœ‹çœ‹æ•´ä¸ªç»†èŠ‚çš„é€»è¾‘ï¼Œæƒ³æƒ³ä¸ºä»€ä¹ˆè¿™å„¿è®¾è®¡ç­‰ç­‰ï¼Œæ„Ÿè§¦å¾ˆæ·±ï¼Œä¹Ÿæ·±çŸ¥è‡ªå·±ä¸ä»–ä»¬è¿˜æ˜¯æœ‰å·®è·çš„ï¼Œæˆ‘éœ€è¦å¥½å¥½çš„åŠªåŠ›ï¼Œå°½é‡ç¼©å°è¿™ä¸ªå·®è·ï¼Œæ‰€ä»¥å¯¹æˆ‘æ¥è¯´ï¼Œç§‘ç ”æ˜¯å¿…é¡»è¦å¥½å¥½ç§¯ç´¯çš„ï¼Œå›å»çš„è¿™æ®µæ—¶é—´ä¹Ÿä¸èƒ½æ”¾æ¾ï¼Œéœ€è¦å¥½å¥½çš„ç ”ç©¶ä¸€ä¸‹åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç ”ç©¶åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç­‰é—®é¢˜ï¼Œè¿™æ ·å¯ä»¥æœ‰æ›´å¤šçš„æœºä¼šå‘ç°ä¸€ä¸ªå¥½çš„ideaï¼Œå¯¹äºPHDæ¥è¯´ï¼Œå¯èƒ½ä¸€ä¸ªideaæ˜¯éå¸¸é‡è¦çš„å§ï¼Œå­¦é•¿ä»¬åŠ æ²¹ï¼Œæˆ‘è‡ªå·±ä¹ŸåŠ æ²¹ã€‚&lt;/p&gt;

&lt;p&gt;å›å»çš„æ—¶é—´é‡Œï¼Œé¦–å…ˆè¦æŒæ¡Samza standaloneæºç ï¼Œç„¶åæ˜¯YARNåŸç†ã€æºç é˜…è¯»ï¼Œæˆ‘è§‰å¾—è¿™æ¬¡å¯ä»¥ç”¨Sparkåšä¸€äº›å®éªŒè¿›è¡ŒYARNçš„ç†è§£ï¼Œè¿™æ ·åº”è¯¥èƒ½åŠ æ·±æˆ‘å¯¹Sparkçš„ç†è§£ä»¥åŠå¯¹YARNçš„ç†è§£ï¼Œä¹‹å‰åªç”¨è¿‡Samzaï¼Œæ‰€ä»¥è¿˜æ˜¯è¦å¥½å¥½è¯•ä¸€ä¸‹å…¶ä»–ä¸œè¥¿å‘¢ï¼Œç°åœ¨è‡ªå·±è¿˜æ˜¯å¤„äºä¸€ä¸ªlow levelçš„é˜¶æ®µï¼Œéœ€è¦ä¸æ–­çš„è¡¥å……è¿™ä¸ªæ–¹å‘çš„åŸºç¡€ï¼Œæ‰“ç‰¢åŸºç¡€ï¼Œæ‰èƒ½å‘å‰èµ°ï¼Œåšç§¯è€Œè–„å‘ï¼Œç»ƒä¹ è‹±è¯­è¿™ä¸ªæ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œå†™çš„æ¯å¥è¯éƒ½éœ€è¦å¥½å¥½æƒ³æƒ³ï¼Œåå¤æ–Ÿé…Œæ‰è¡Œï¼Œä¸ç„¶æ²¡æœ‰ä»»ä½•æ˜¯è¿›æ­¥çš„ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ„¿è¿™æ¬¡èƒ½å¤Ÿé¡ºåˆ©è¿›å…¥masterçš„æ”»è¯»ï¼Œç„¶åé¡ºåˆ©è¿›å…¥PHDï¼Œgod bless me.&lt;/p&gt;
</description>
        <pubDate>Thu, 10 May 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/05/10/NGNE%E6%80%BB%E7%BB%93/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/05/10/NGNE%E6%80%BB%E7%BB%93/</guid>
        
        
      </item>
    
      <item>
        <title>Latexå­¦ä¹ ç¬”è®°</title>
        <description>&lt;h1 id=&quot;latexå­¦ä¹ ç¬”è®°&quot;&gt;latexå­¦ä¹ ç¬”è®°&lt;/h1&gt;

&lt;h3 id=&quot;ç¯å¢ƒæ­å»º&quot;&gt;ç¯å¢ƒæ­å»º&lt;/h3&gt;

&lt;p&gt;ä¹‹å‰ä½¿ç”¨mikTex + Texmaker
ç°åœ¨ä½¿ç”¨sublime + mikTex + pdfviewer&lt;/p&gt;

&lt;h3 id=&quot;è¯­æ³•å­¦ä¹ &quot;&gt;è¯­æ³•å­¦ä¹ &lt;/h3&gt;

&lt;h4 id=&quot;documentclassarticle&quot;&gt;\documentclass{article}&lt;/h4&gt;

&lt;p&gt;è¿™ç¯‡æ–‡æ¡£çš„ç±»å‹æ˜¯å­¦æœ¯æ–‡ç« ï¼Œé™¤æ­¤ä¹‹å¤–ä¹Ÿæœ‰bookï¼Œbookletç­‰å…¶ä»–å‡ºç‰ˆç‰©ç±»å‹ï¼Œè¿™ä¸€å¥é™å®šäº†æ’ç‰ˆèƒ½å¤Ÿä½¿ç”¨çš„æ ¼å¼ï¼Œæ¯”å¦‚è¯´å¦‚æœç±»å‹æ˜¯articleï¼Œé‚£ä¹ˆæ’ç‰ˆå°±å¯ä»¥ç”¨APA/Chicago/MLAç­‰ç‰ˆå¼ï¼Œè€Œä¸æ˜¯ä¸“ç”¨äºbookletçš„ä¸€äº›ç‰ˆå¼ï¼›&lt;/p&gt;

&lt;h4 id=&quot;userpackage&quot;&gt;\userpackage&lt;/h4&gt;

&lt;p&gt;åº”è¯¥æ˜¯å¼•ç”¨å„ç§åŒ…çš„apiï¼Œè¿™ä¸ªè‚¯å®šå°±æ¯”è¾ƒä¸ªæ€§åŒ–äº†ã€‚å¯ä»¥è®°å½•å‡ ä¸ªæ¯”è¾ƒé€šç”¨çš„&lt;/p&gt;

&lt;p&gt;æ–‡å­—æ’ç‰ˆæ˜¯natbib&lt;/p&gt;

&lt;p&gt;å›¾è¡¨æ’ç‰ˆæ˜¯graphicx &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\includegraphics[scale=0.4]{t1.jpg}&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;title&quot;&gt;\title&lt;/h4&gt;

&lt;p&gt;æ˜¯æ•´ä¸ªæ–‡æ¡£çš„æ ‡é¢˜ï¼Œä¼šè‡ªåŠ¨å±…ä¸­ã€‚&lt;/p&gt;

&lt;h4 id=&quot;authorå’Œdate&quot;&gt;\authorå’Œ\date&lt;/h4&gt;

&lt;p&gt;æ˜¯æ–‡æ¡£çš„ä½œè€…å’Œæ—¥æœŸä¿¡æ¯ï¼Œå¦‚æœæƒ³è®©dateè‡ªåŠ¨æ˜¾ç¤ºä»Šå¤©çš„æ—¥æœŸï¼Œå°±æŠŠè¿™ä¸€è¡Œæ”¹ä¸º\date{\today}ã€‚&lt;/p&gt;

&lt;h4 id=&quot;begindocument&quot;&gt;\begin{document}&lt;/h4&gt;

&lt;p&gt;æ˜¯æ­£æ–‡æ­£å¼çš„å¼€å§‹æ ‡å¿—ã€‚&lt;/p&gt;

&lt;h4 id=&quot;maketitle&quot;&gt;\maketitle&lt;/h4&gt;

&lt;p&gt;å‘½ä»¤çš„ä½œç”¨æ˜¯æŠŠæ ‡é¢˜ä¿¡æ¯ä¹‹å‰çš„\titleï¼Œ\authorï¼Œ\dateç­‰æ˜¾ç¤ºå‡ºæ¥ã€‚&lt;/p&gt;

&lt;h4 id=&quot;newenvironment&quot;&gt;\newenvironment&lt;/h4&gt;

&lt;p&gt;æ–°å»ºç¯å¢ƒ\newenvironment{name}[num]{before}{after}&lt;/p&gt;

&lt;h3 id=&quot;beginparam&quot;&gt;\begin{param}&lt;/h3&gt;

&lt;p&gt;param: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;enumerate&lt;/code&gt; æšä¸¾é»˜è®¤ä¸ºæ•°å­—ï¼Œå¯ä»¥è®¾ç½®å­—æ¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\begin{enumerate}[label=\alph*)]&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥è®¾ç½®å¾ˆå¤šï¼Œç›®å‰æœ€å¤šçš„æ˜¯è‡ªå®šä¹‰çš„ç¯å¢ƒï¼Œæ„Ÿè§‰beginæ˜¯ä¸€ä¸ªæ®µå¼€å§‹ï¼Œé‡Œé¢çš„paramå°±æ˜¯å¸®åŠ©åˆå§‹åŒ–æ ¼å¼çš„ã€‚&lt;/p&gt;
</description>
        <pubDate>Sun, 04 Feb 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/02/04/latex%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/02/04/latex%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        
      </item>
    
      <item>
        <title>Stormå­¦ä¹ ç¬”è®°</title>
        <description>&lt;h2 id=&quot;storm&quot;&gt;Storm&lt;/h2&gt;

&lt;h3 id=&quot;concept&quot;&gt;concept&lt;/h3&gt;

&lt;p&gt;stormå·¥ç¨‹ç»“æ„ï¼Œnimbusç±»ä¼¼äºmasterï¼Œsupervisorç±»ä¼¼äºslaveã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201404/15/225641mt3v1okkkrkkp3rk.jpg&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;topologyï¼šstormä¸­çš„jobï¼ŒåŒ…æ‹¬ä¸¤ç±»ç»„ä»¶spoutå’Œbolt&lt;/p&gt;

&lt;p&gt;spoutå¯ä»¥é›†æˆæ¶ˆæ¯é˜Ÿåˆ—å’Œæ•°æ®åº“ç³»ç»Ÿï¼Œä»ä¸­è·å–æ•°æ®ï¼Œå¯ä»¥ä»rabbitMQï¼Œkestrelï¼ŒAMQPï¼ŒKafkaç­‰è·å–ã€‚æ˜¯æµæ•°æ®æºå¤´ï¼Œæ„æ€æ˜¯å®ƒç±»ä¼¼äºproducer&lt;/p&gt;

&lt;p&gt;boltå¯ä»¥è¿æ¥æ•°æ®åº“è¿›è¡Œæ“ä½œã€‚ä¾‹å¦‚NoSQLçš„cassandraï¼Œrdbmsï¼Œæ˜¯æ¥å—æµæ•°æ®å¤„ç†çš„ä½œç”¨ï¼Œç±»ä¼¼äºconsumerï¼Œå¯ä»¥å¤„ç†æµæ•°æ®ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201404/15/225643pjbhjccbkt94cmst.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ç³»ç»Ÿç»“æ„&quot;&gt;ç³»ç»Ÿç»“æ„&lt;/h3&gt;

</description>
        <pubDate>Sun, 24 Dec 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/12/24/storm%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/24/storm%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        
      </item>
    
      <item>
        <title>Samzaå­¦ä¹ ç¬”è®°</title>
        <description>&lt;h3 id=&quot;samza&quot;&gt;Samza&lt;/h3&gt;

&lt;h3 id=&quot;samza-1&quot;&gt;Samza&lt;/h3&gt;

&lt;p&gt;Samza is a stream processing framework with the following features:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Simple API:&lt;/strong&gt; Unlike most low-level messaging system APIs, Samza provides a very simple callback-based â€œprocess messageâ€ API comparable to MapReduce.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Managed state:&lt;/strong&gt; Samza manages snapshotting and restoration of a stream processorâ€™s state. When the processor is restarted, Samza restores its state to a consistent snapshot. Samza is built to handle large amounts of state (many gigabytes per partition).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Fault tolerance:&lt;/strong&gt; Whenever a machine in the cluster fails, Samza works with YARN to transparently migrate your tasks to another machine.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Durability:&lt;/strong&gt; Samza uses Kafka to guarantee that messages are processed in the order they were written to a partition, and that no messages are ever lost.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Scalability:&lt;/strong&gt; Samza is partitioned and distributed at every level. Kafka provides ordered, partitioned, replayable, fault-tolerant streams. YARN provides a distributed environment for Samza containers to run in.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Pluggable:&lt;/strong&gt; Though Samza works out of the box with Kafka and YARN, Samza provides a pluggable API that lets you run Samza with other messaging systems and execution environments.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Processor isolation:&lt;/strong&gt; Samza works with Apache YARN, which supports Hadoopâ€™s security model, and resource isolation through Linux CGroups.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/17-11-22/98296127.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;samzaè¿è¡ŒåŸç†&quot;&gt;samzaè¿è¡ŒåŸç†&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150918145544673&quot; alt=&quot;è¿™é‡Œå†™å›¾ç‰‡æè¿°&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Samzaçš„Jobæ˜¯è¿è¡Œåœ¨Yarnä¸Šçš„ã€‚&lt;/p&gt;

&lt;p&gt;æ¶æ„å›¾ä¸­å±•ç°çš„æ˜¯æäº¤2ä¸ªJobç¤ºä¾‹ã€‚ 
æäº¤ä¸€ä¸ªJobçš„åŸºæœ¬è¿‡ç¨‹ï¼š 
-  Clientå°†Jobæäº¤åˆ°RMï¼ˆä½¿ç”¨YarnClient ç±»ï¼‰
- RMæ ¹æ®å½“å‰èµ„æºåˆ†é…Node Managerèµ„æºè¿è¡ŒApp Master
- App Masterå‘RMç”³è¯·è¿è¡ŒContainerçš„Node Managerèµ„æºï¼Œå¾—åˆ°èµ„æºåè¿è¡ŒContainer 
- Containerä¸­æ‰§è¡Œä½ æäº¤çš„Job&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹å‡ºè¦åœ¨Yarnä¸Šè¿è¡Œä¸€ä¸ªJobéœ€è¦æœ‰ä¸‰æ ·ä¸œè¥¿ï¼š 
- Clientï¼šæäº¤Jobåˆ°Yarnä¸Š 
- App Masterï¼šç”³è¯·èµ„æºã€å¯åŠ¨Container 
- Containerï¼šè¿è¡Œç¨‹åºï¼ˆæˆ‘ä»¬å†™çš„å¤„ç†ç¨‹åºå°±åœ¨è¿™é‡Œè¿è¡Œï¼‰&lt;/p&gt;

&lt;p&gt;Samzaæ˜¯å¦‚ä½•å°†Jobè¿è¡Œåœ¨Yarnä¸Šçš„&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150917171623774&quot; alt=&quot;Samzaçš„Jobæäº¤è¿‡ç¨‹&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;åœ¨Samzaä¸­æ˜¯åˆ©ç”¨JobRunneræäº¤Jobåˆ°RMä¸­çš„ï¼Œ&lt;strong&gt;ç”±äºSamzaå¯¹äºYarnã€Kafkaæ˜¯å¯æ’æ‹”çš„ï¼ˆpluggableï¼‰&lt;/strong&gt;ï¼Œå› æ­¤åœ¨æ­¤å¤„è°ƒç”¨äº†YarnJobç±»å®é™…å®Œæˆè¿™ä¸ªåŠŸèƒ½çš„ã€‚&lt;/li&gt;
  &lt;li&gt;Samzaä¸­çš„AppMasterå°±æ˜¯SamzaAppMasterç±»ï¼Œè¯¥ç±»ä¸RMé€šä¿¡ï¼Œç”³è¯·èµ„æºï¼Œä¸NMé€šä¿¡å¯åŠ¨è‡ªå·±çš„Containerâ€”SamzaContainer&lt;/li&gt;
  &lt;li&gt;SamzaContainerå¯åŠ¨åï¼Œä¼šæ‰§è¡Œæˆ‘ä»¬å†™çš„Taskã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;clientæäº¤jobå¯åŠ¨samzaappmasterçš„è¿‡ç¨‹&quot;&gt;Clientæäº¤Jobï¼Œå¯åŠ¨SamzaAppMasterçš„è¿‡ç¨‹&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150918151755538&quot; alt=&quot;SamzaAppMsterå¯åŠ¨çš„è¿‡ç¨‹&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Samzaæ˜¯åˆ©ç”¨bin/run-job.shæäº¤Jobçš„ï¼Œä¾‹ï¼ˆhello-samzaä¸­æäº¤Jobï¼‰ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;deploy/samza/bin/run-job.sh &lt;span class=&quot;nt&quot;&gt;--config-factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;org.apache.samza.config.factories.PropertiesConfigFactory &lt;span class=&quot;nt&quot;&gt;--config-path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;file://&lt;span class=&quot;nv&quot;&gt;$PWD&lt;/span&gt;/deploy/samza/config/wikipedia-feed.properties
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è„šæœ¬å®é™…è°ƒç”¨org.apache.samza.job.JobRunneræ¥è§£æé…ç½®æ–‡ä»¶ï¼Œä»¥åŠæäº¤Jobçš„ã€‚ 
run-job.shçš„å†…å®¹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dirname&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;/run-class.sh &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;org.apache.samza.job.JobRunner&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç”±äºé…ç½®æ–‡ä»¶ä¸­&lt;code&gt;job.factory.class=org.apache.samza.job.yarn.YarnJobFactory&lt;/code&gt;(è¯¥å¤„å¯ä»¥é…ç½®ProcessJobFactoryæˆ–è€…ThreadJobFactoryï¼Œä½†æˆ‘åªåˆ†æè¿è¡Œåœ¨Yarnä¸Šçš„æƒ…å†µ)ï¼Œå› æ­¤åœ¨JobRunnerä¸­å®é™…è°ƒç”¨äº†YarnJobçš„submit,åœ¨submitä¸­è°ƒç”¨çš„æ˜¯YarnClientçš„submitApplicationæ–¹æ³•ï¼Œyarnæä¾›api submitApplicationå°†ä»»åŠ¡ä¸Šä¼ åˆ°yarnï¼Œè¿™ä¸€å—æ²¡æœ‰ä»”ç»†ç ”ç©¶ï¼Œä¸è¿‡ä»£ç è·Ÿè¸ªåº”è¯¥ç›¸ä¼¼ï¼Œyarnå‘é€æŒ‡ä»¤run-am.shï¼Œåˆ›å»ºä¸€ä¸ªappmasterï¼Œè¿™ä¸ªä¸‹ä¸€ç« è®²ã€‚å…¶ä¸­submitApplicationä¸­æ¥æ”¶äº†ä¸€ä¸ªç±»å‹ä¸ºApplicationSubmissionContextå‚æ•°ï¼Œå…¶ä¸­ä¸»è¦åŒ…æ‹¬packageï¼ˆæˆ‘ä»¬å†™çš„ç¨‹åºçš„jaråŒ…ï¼‰çš„pathï¼Œä»¥åŠå¯åŠ¨SamzaAppMasterå‘½ä»¤è¡Œã€‚è¯¦ç»†ä»£ç ï¼š&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;submit&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;YarnJob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;appId&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;submitApplication&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*å®é™…è°ƒç”¨çš„æ˜¯YarnClientçš„submitApplicationï¼ŒYarnClientè¿™ä¸ªç±»ä¸»è¦æ˜¯å°†jobæäº¤ç»™Yarnçš„RM*/&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getPackagePath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No YARN package path defined in config.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*APKçš„è·¯å¾„ï¼Œâ‘ httpå¯ä»¥ä¸‹è½½çš„urlâ‘¡hdfsçš„è·¯å¾„*/&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getAMContainerMaxMemoryMb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DEFAULT_AM_CONTAINER_MEM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt;
      &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;export SAMZA_LOG_DIR=%s &amp;amp;&amp;amp; ln -sfn %s logs &amp;amp;&amp;amp; exec ./__package/bin/run-am.sh 1&amp;gt;logs/%s 2&amp;gt;logs/%s&quot;&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Yarnçš„RMä¼šæ‰§è¡Œrun-am.shæ¥å¯åŠ¨Samzaçš„SamzaAppMaster*/&lt;/span&gt;
          &lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;LOG_DIR_EXPANSION_VAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;LOG_DIR_EXPANSION_VAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;STDOUT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;STDERR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)),&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;({&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;envMap&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;ShellCommandConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;ENV_CONFIG&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;envVarEscape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SamzaObjectMapper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getObjectMapper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;writeValueAsString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)),&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;ShellCommandConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;ENV_JAVA_OPTS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;envVarEscape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getAmOpts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;envMapWithJavaHome&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getAMJavaHome&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;javaHome&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envMap&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ShellCommandConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;ENV_JAVA_HOME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;javaHome&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*ä¸€äº›ç¯å¢ƒå˜é‡*/&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envMap&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;envMapWithJavaHome&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}),&lt;/span&gt;

      &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s_%s&quot;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getJobId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;appCtx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setAMContainerSpec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containerCtx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;appCtx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setApplicationType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ClientHelper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;applicationType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submitting application request for %s&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;appId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;yarnClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;submitApplication&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appCtx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå·²ç»å°†æˆ‘ä»¬çš„Jobæäº¤ç»™Yarnçš„RMï¼Œå¹¶ä¸”RMå¯ä»¥å¯åŠ¨SamzaAppMasterã€‚&lt;/p&gt;

&lt;h4 id=&quot;samzaappmasterç”³è¯·èµ„æºå¯åŠ¨containerçš„è¿‡ç¨‹&quot;&gt;SamzaAppMasterç”³è¯·èµ„æºã€å¯åŠ¨Containerçš„è¿‡ç¨‹&lt;/h4&gt;

&lt;p&gt;SamzaAppMasterå®ç°äº† AMRMClientAsync.CallbackHandleræ¥å£ã€‚è¯¥æ¥å£çš„ä½œç”¨æ˜¯AppMasterå‘Yarnçš„RMç”³è¯·èµ„æºæˆåŠŸåçš„å›è°ƒå‡½æ•°ï¼Œç”¨ä»¥é€šçŸ¥SamzaAppMasterã€‚SamzaAppMasteræ¥åˆ°é€šçŸ¥åé€šçŸ¥Yarnçš„Node Manergeræ¥å¯åŠ¨SamzaContainerï¼Œè¿™æ ·æˆ‘ä»¬çš„Jobå°±ä¼šè¢«æ‰§è¡Œäº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150918142727408&quot; alt=&quot;SamzaContainerå¯åŠ¨è¿‡ç¨‹&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMaster&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Logging&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;AMRMClientAsync&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;CallbackHandler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;amClient&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;AMRMClientAsync&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;createAMRMClientAsync&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ContainerRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*this:å°†è‡ªå·±æ³¨å†Œç»™Yarnçš„RMï¼Œå¾…èµ„æºç”³è¯·æˆåŠŸåä¼šè°ƒç”¨è‡ªå·±ç±»çš„onContainersAllocated*/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;containerId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nodeHostString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;nodePortString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;nodeHttpPortString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;service&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;registry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clientHelper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lifecycle&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterLifecycle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containerMem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;containerCpu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;registry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;am&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterTaskManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentTimeMillis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*è¿™ä¸ªç±»ä¸»è¦ä¸NMé€šä¿¡ï¼Œå¹¶å¯åŠ¨Container*/&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;listeners&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lifecycle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;am&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;listeners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/**/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

 &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;AMRMClientAsync&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ContainerRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;listeners&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;YarnAppMasterListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hConfig&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;YarnConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interval&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;listeners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;onInit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*æ­¤å¤„å¯åŠ¨æ‰€æœ‰ç›‘å¬å’ŒæœåŠ¡ï¼Œä¹Ÿå¯åŠ¨äº†SamzaAppMasterTaskManagerç±»*/&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;


  &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onContainersAllocated&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;java.util.List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;listeners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;onContainerAllocated&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*èµ„æºç”³è¯·æˆåŠŸï¼ŒYarn çš„RMçš„å›è°ƒï¼ˆå›¾ä¸­çš„3ï¼‰ï¼ŒçœŸæ­£å¯åŠ¨SamzaContainerçš„æ˜¯SamzaAppMasterTaskManagerç±»ä¸­çš„onContainerAllocatedå‡½æ•°*/&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;--------------------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;SamzaAppMasterTaskManagerç±»&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ï¼š&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onInit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;neededContainers&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;taskCount&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;unclaimedTasks&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;jobCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;jobModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getContainers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;keySet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toSet&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;containerManager&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;NMClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;createNMClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;containerManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;containerManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*å»ºç«‹ä¸NMçš„é€šä¿¡*/&lt;/span&gt;

    &lt;span class=&quot;nf&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Requesting %s containers&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;taskCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;requestContainers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getContainerMaxMemoryMb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DEFAULT_CONTAINER_MEM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getContainerMaxCpuCores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DEFAULT_CPU_CORES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;neededContainers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*å‘RMç”³è¯·èµ„æºï¼ˆå›¾ä¸­çš„1.1ï¼‰*/&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onContainerAllocated&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Containerç”³è¯·æˆåŠŸåçš„å›è°ƒå‡½æ•°*/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilderClassName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getCommandClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ShellCommandBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*è·å¾—ShellCommandBuilderç±»ï¼Œæ­¤ç±»ä¸­åŒ…å«å¯åŠ¨SamzaContainerçš„è„šæœ¬å‘½ä»¤*/&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilder&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmdBuilderClassName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;asInstanceOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CommandBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;coordinatorUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;buildCommand&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*å¾—åˆ°çš„å°±æ˜¯bin/run-container.sh*/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilderClassName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getCommandClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ShellCommandBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilder&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmdBuilderClassName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;asInstanceOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CommandBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;coordinatorUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;buildCommand&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

 &lt;span class=&quot;nf&quot;&gt;startContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*è°ƒç”¨å†…éƒ¨å‡½æ•°ï¼Œå®é™…è°ƒç”¨çš„æ˜¯NMClient.createNMClient().startContainer()*/&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*æˆ‘ä»¬æäº¤çš„PKGçš„è·¯å¾„*/&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;&quot;export SAMZA_LOG_DIR=%s &amp;amp;&amp;amp; ln -sfn %s logs &amp;amp;&amp;amp; exec ./__package/%s 1&amp;gt;logs/%s 2&amp;gt;logs/%s&quot;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;LOG_DIR_EXPANSION_VAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;LOG_DIR_EXPANSION_VAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*æ­¤å¤„å°†å¯åŠ¨SamzaContainerçš„è„šæœ¬ä¼ é€’ç»™NMï¼ŒNMå¾—åˆ°PKGçš„è·¯å¾„åå°†PKGè§£å‹ï¼Œä¹‹åå°±å¯ä»¥æ‰§è¡Œè„šæœ¬å¯åŠ¨Container*/&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;STDOUT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;STDERR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;


 &lt;span class=&quot;k&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;startContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packagePath&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;nv&quot;&gt;containerManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;startContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;samzacontainerè¿è¡Œtaskçš„è¿‡ç¨‹&quot;&gt;SamzaContainerè¿è¡ŒTaskçš„è¿‡ç¨‹&lt;/h4&gt;

&lt;p&gt;å…·ä½“æ‰§è¡Œçš„è¿‡ç¨‹SamzaContainerâ€“&amp;gt;mainâ€“&amp;gt;safeMainâ€“&amp;gt;applyâ€“&amp;gt;runâ€“&amp;gt;RunLoop.runâ€“&amp;gt;RunLoop.process 
è§£é‡Šï¼š 
1ã€main: mainæ˜¯é»˜è®¤è¢«æ‰§è¡Œçš„ï¼Œé‡Œé¢ç›´æ¥è°ƒç”¨äº†safeMain 
2ã€safeMain: åœ¨safeMainæœ€åè°ƒç”¨äº†Objectçš„SamzaContainer(containerModel, jobModel).run 
3ã€apply: ç”±äºSamzaContaineræ˜¯Objectï¼Œé‚£ä¹ˆé¦–å…ˆä¼šé»˜è®¤ä¼šæ‰§è¡Œapplyï¼Œåœ¨applyä¸­ä¸»è¦æ˜¯å¯¹ä¸€äº›å˜é‡èµ‹å€¼ã€åˆå§‹åŒ–ï¼ŒåŒ…æ‹¬åˆå§‹åŒ–Taskå®ä¾‹ 
4ã€run: åœ¨runä¸­ä¸»è¦å¼€å§‹å¯¹æ¶ˆæ¯å¼€å§‹è½®è®­å¤„ç† 
5ã€RunLoop.run: RunLoop.runè¿™ä¸ªæ˜¯çœŸæ­£å‘processé‡Œè¯»å–æ•°æ®çš„çº¿ç¨‹ 
6ã€RunLoop.process: RunLoop.processä¼šæœ€ç»ˆè°ƒç”¨æˆ‘ä»¬å†™çš„å‡½æ•°&lt;/p&gt;

&lt;p&gt;SamzaContaineræºç åˆ°applyï¼š&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaContainer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Logging&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;safeMain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JmxServer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaContainerExceptionHandler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;safeMain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;jmxServer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;newJmxServer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;SamzaContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containerModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jobModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*è¿™é‡Œå¼€å§‹æ‰§è¡Œäº†*/&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*---------------------------------------------------*/&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*applyå‡½æ•°ï¼šåˆå§‹åŒ–Taskå®ä¾‹*/&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containerModel&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ContainerModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jobModel&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;JobModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskClassName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getTaskClass&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No task class defined in configuration.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/*è·å–é…ç½®æ–‡ä»¶ä¸­çš„val TASK_CLASS = &quot;task.class&quot; // streaming.task-factory-class*/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*ä¸‹é¢å°±æ˜¯è·å–Taskçš„å®ä¾‹*/&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstances&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;TaskName&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;TaskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;containerModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getTasks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskModel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nf&quot;&gt;debug&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Setting up task instance: %s&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getTaskName&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;StreamTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskClassName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstanceMetrics&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TaskName-%s&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;collector&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskInstanceCollector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;producerMultiplexer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;storeConsumers&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;changeLogSystemStreams&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nf&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;storeName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;changeLogSystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;systemConsumer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;systemFactories&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;changeLogSystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getSystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Changelog system %s for store %s does not exist in the config.&quot;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changeLogSystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;storeName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getConsumer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;changeLogSystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getSystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;registry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;storeName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;systemConsumer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toMap&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;cm&quot;&gt;/*çœŸæ­£çš„Taskç”Ÿæˆäº†*/&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstance&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;taskName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*è¿™ä¸ªè·å–çš„å°±æ˜¯é…ç½®æ–‡ä»¶ä¸­task.classå£°æ˜çš„ç±»*/&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;consumerMultiplexer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;consumerMultiplexer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;offsetManager&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offsetManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;storageManager&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;storageManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reporters&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reporters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;systemStreamPartitions&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;systemStreamPartitions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;exceptionHandler&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskInstanceExceptionHandler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toMap&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;runå‡½æ•°ï¼šåœ¨runä¸­ä¸»è¦å¼€å§‹å¯¹æ¶ˆæ¯å¼€å§‹è½®è®­å¤„ç†&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Starting container.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/*å¯åŠ¨&amp;amp;åˆå§‹åŒ–è¿›ç¨‹*/&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startMetrics&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startOffsetManager&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startStores&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startProducers&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startTask&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startConsumers&lt;/span&gt;

      &lt;span class=&quot;nf&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Entering run loop.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;runLoop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*è¿™ä¸ªæ˜¯çœŸæ­£çš„è·å–Kafkaä¸­çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯æˆ‘å†™çš„processå°±åœ¨è¿™é‡Œ*/&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;e:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Caught exception in process loop.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Shutting down.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;shutdownConsumers&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownTask&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownProducers&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownStores&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownOffsetManager&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownMetrics&lt;/span&gt;

      &lt;span class=&quot;nf&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Shutdown complete.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looper.runå‡½æ•°ï¼šè¿™ä¸ªæ˜¯çœŸæ­£å‘processé‡Œè¯»å–æ•°æ®çš„çº¿ç¨‹&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;addShutdownHook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;

    &lt;span class=&quot;nf&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shutdownNow&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;  &lt;span class=&quot;cm&quot;&gt;/*æ‰¾åˆ°äº†ï¼Œåœ¨è¿™é‡Œ*/&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;window&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;commit&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;processå‡½æ•°ï¼šRunLoop.processä¼šæœ€ç»ˆè°ƒç”¨æˆ‘ä»¬å†™çš„å‡½æ•°&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;process&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Attempting to choose a message to process.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;processes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;inc&lt;/span&gt;

    &lt;span class=&quot;nf&quot;&gt;updateTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;processMs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;envelope&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;updateTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;chooseMs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;consumerMultiplexer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;choose&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

      &lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;envelope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ssp&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;envelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getSystemStreamPartition&lt;/span&gt;

        &lt;span class=&quot;nf&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Processing incoming message envelope for SSP %s.&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;envelopes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;inc&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstance&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;systemStreamPartitionToTaskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ssp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;coordinator&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReadableCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;taskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;taskName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;nv&quot;&gt;taskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;envelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰äº†ï¼Œæˆ‘ä»¬å†™çš„ç¨‹åºç»ˆäºè¢«è°ƒç”¨äº†*/&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;checkCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No incoming message envelope was available.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;nullEnvelopes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;inc&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆ°æ­¤æˆ‘ä»¬çš„ç¨‹åºåœ¨Yarnä¸Šå·²ç»è¿è¡Œäº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç»“æ„&quot;&gt;ç»“æ„&lt;/h3&gt;

&lt;p&gt;Samza is made up of three layers:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;A streaming layer. Kafka&lt;/li&gt;
  &lt;li&gt;An execution layer. YARN&lt;/li&gt;
  &lt;li&gt;A processing layer. Samza API(ç°åœ¨çš„ç†è§£æ˜¯samzaå°±æ˜¯ä¸€ä¸ªåº“ï¼Œæä¾›äº†apiä½¿kafkaèƒ½å¤Ÿæ•°æ®æµå¤„ç†)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;http://samza.apache.org/img/0.13/learn/documentation/introduction/samza-ecosystem.png&quot; alt=&quot;diagram-medium&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å’Œhadoopçš„æ¨¡å¼æœ‰ç‚¹ç›¸ä¼¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://samza.apache.org/img/0.13/learn/documentation/introduction/samza-hadoop.png&quot; alt=&quot;diagram-medium&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å®˜ç½‘è¯´Samzaä¸å±€é™äºYARNå’ŒKafkaï¼Œåº”è¯¥å°±æŒ‡çš„ä»–çš„å¯æ’å…¥æ€§ï¼ˆpluggableï¼‰å§ã€‚&lt;/p&gt;

&lt;p&gt;å®˜ç½‘samzaè¿è¡Œæµç¨‹å›¾ï¼š&lt;/p&gt;

&lt;p&gt;clientå‘RMå‘é€å¼€å§‹ä¸€ä¸ªsamza jobçš„è¯·æ±‚
RMæ¥æ”¶è¯·æ±‚å‘ä¸€ä¸ªNMå‘é€æŒ‡ä»¤ï¼Œåˆ†é…èµ„æºï¼Œåˆ›å»ºä¸€ä¸ªAppMaster
AppMasterä¸RMé€šä¿¡ï¼Œè¯·æ±‚åˆ›å»ºcontainerè·‘taskï¼ŒRMå‘ä¸€ä¸ªNMå‘é€æŒ‡ä»¤åˆ›å»ºsamza task runner
samza task runnerå°†åœ¨brokerä¸Šåˆ›å»ºä»»åŠ¡ï¼Œå¯ä»¥åœ¨å¤šä¸ªbrokerä¸Šé¢åˆ›å»ºã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://samza.apache.org/img/0.13/learn/documentation/introduction/samza-yarn-kafka-integration.png&quot; alt=&quot;diagram-small&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚ä¸€ä¸ªä¾‹å­ï¼ŒSELECT user_id, COUNT(*) FROM PageViewEvent GROUP BY user_idï¼Œè®¡ç®—æ¯ä¸ªuseridçš„é¡µé¢æŸ¥çœ‹æ¬¡æ•°ï¼Œå°†ä¼šè·‘ä¸¤ä¸ªä»»åŠ¡ï¼Œä¸€ä¸ªä»»åŠ¡è´Ÿè´£groupbyçš„ä»»åŠ¡ï¼Œå°†å…³é”®å­—èšåˆï¼Œå‘é€åŒä¸€ä¸ªIDçš„æ¶ˆæ¯åˆ°ä¸€ä¸ªä¸­é—´topicçš„ä¸€ä¸ªåˆ†åŒºä¸­ï¼Œå¦ä¸€ä¸ªä»»åŠ¡è´Ÿè´£æ¶ˆè´¹topicè¿›è¡Œç»Ÿè®¡ï¼Œç¬¬äºŒä¸ªä»»åŠ¡ä¸­çš„æ¯ä¸ªtaskæ¶ˆè´¹ä¸­é—´topicçš„ä¸€ä¸ªåˆ†åŒºï¼Œè¿™æ ·å»ºç«‹ä¸€ä¸ªè®¡æ•°å™¨ï¼Œè¿›è¡Œç»Ÿè®¡ã€‚è¿™æ ·å°±ç±»ä¼¼äºä¸€ä¸ªwordcountçš„åŠŸèƒ½äº†å§ï¼Ÿæƒ³æƒ³æˆç»Ÿè®¡ä¸€ç¯‡æ–‡ç« ï¼Œå°†æ‰€æœ‰çš„å•è¯æ‹†åˆ†æˆä¸€ä¸ªIDï¼Œæ”¾å…¥topicçš„partitionï¼Œè®©consumerä¸­taskæ¥è®¡ç®—ã€‚ï¼ˆ&lt;strong&gt;æ³¨æ„jobå’Œtaskçš„åŒºåˆ«&lt;/strong&gt;ï¼Œç†è§£ä¸ºä¸€ä¸ªæ˜¯ä½œä¸šï¼ŒåŒ…å«å¤šä¸ªä»»åŠ¡ï¼‰&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://samza.apache.org/img/0.13/learn/documentation/introduction/group-by-example.png&quot; alt=&quot;é‡æ–°åˆ’åˆ†GROUP BY&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;åˆ›å»ºä¸€ä¸ªsamzaé¡¹ç›®&quot;&gt;åˆ›å»ºä¸€ä¸ªsamzaé¡¹ç›®&lt;/h3&gt;

&lt;p&gt;ç¼–å†™pom.xmlï¼Œæ·»åŠ ä¾èµ–ï¼Œä½¿ç”¨mavenè¿›è¡Œæ‰“åŒ…ã€‚&lt;/p&gt;

&lt;p&gt;ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;p&gt;config.properties&lt;/p&gt;

&lt;div class=&quot;language-properties highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#Job
#æŒ‡å®šè¿è¡Œç¯å¢ƒï¼Œæœ¬åœ°æµ‹è¯•ä½¿ç”¨ThreadJobFactoryæˆ–ProcessJobFactory
#job.factory.class=org.apache.samza.job.yarn.YarnJobFactory
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;job.factory.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.job.local.ThreadJobFactory&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;job.name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;CountLatancy&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#YARN
#æœ¬åœ°è¿è¡Œæ—¶å¯ä»¥çœç•¥
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;yarn.package.path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;file://{tmp}/filename.tar.gz&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Task
#ä¸»ç±»åï¼ŒåŒ…å.ä¸»ç±»å
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;task.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;samza.CountLatancy&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#ä½¿ç”¨kafkaä½œä¸ºè¾“å…¥æµæ—¶,å­—æ®µå«ä¹‰ä¸ºkafka.topic
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;task.inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;kafka.clickevent&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#windowable job å¿…é¡»é…ç½®ï¼Œå•ä½ä¸ºms
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;task.window.ms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;60000&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#Serializers
#å®šä¹‰åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ç±»
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;serializers.registry.json.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.serializers.JsonSerdeFactory&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;serializers.registry.string.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.serializers.StringSerdeFactory&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;serializers.registry.integer.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.serializers.IntegerSerdeFactory&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Kafka System
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;systems.kafka.samza.factory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.system.kafka.KafkaSystemFactory&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#è¾“å…¥æµçš„é”®å€¼åºåˆ—åŒ–æ—¶ä½¿ç”¨å“ªä¸€ä¸ªåºåˆ—åŒ–ç±»ã€‚
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;systems.kafka.samza.key.serde&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;string&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;systems.kafka.samza.msg.serde&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;string&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;systems.kafka.consumer.zookeeper.connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;localhost:2181&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;systems.kafka.producer.bootstrap.servers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;localhost:9092&lt;/span&gt;


&lt;span class=&quot;c&quot;&gt;# Job Coordinator
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;job.coordinator.system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;kafka&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Normally, this would be 3, but we have only one broker.
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;job.coordinator.replication.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;samzaDemo.java&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;samza&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.Map.Entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.config.Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.system.IncomingMessageEnvelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.system.OutgoingMessageEnvelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.system.SystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.InitableTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.MessageCollector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.StreamTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.TaskContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.TaskCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.WindowableTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.json.JSONObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CountLatancy&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StreamTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;WindowableTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InitableTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;TOPIC_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;pageviews&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SystemStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;kafka&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;TOPIC_NAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;MessageCollector&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskCoordinator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coodinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;//int total = 0;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;entry:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;entrySet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()){&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;{\&quot;name\&quot; : \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                    &lt;span class=&quot;s&quot;&gt;&quot;,\&quot;total_latancyMs\&quot; : &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                    &lt;span class=&quot;s&quot;&gt;&quot;,\&quot;clickNum\&quot; : &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                    &lt;span class=&quot;s&quot;&gt;&quot;,\&quot;aver_lantancyMs\&quot; : &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                    &lt;span class=&quot;s&quot;&gt;&quot;}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OutgoingMessageEnvelope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OutgoingMessageEnvelope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Total messages per window : &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; .&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IncomingMessageEnvelope&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MessageCollector&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;TaskCoordinator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coodinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;JSONObject&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JSONObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;envelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;latancyMs&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;containsKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Config&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;----------------------------------------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;----------------------------------------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;pom.xml&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;project&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:xsi=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;modelVersion&amp;gt;&lt;/span&gt;4.0.0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/modelVersion&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;cn.myc&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samzademo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;0.0.1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;packaging&amp;gt;&lt;/span&gt;jar&lt;span class=&quot;nt&quot;&gt;&amp;lt;/packaging&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;samzademo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;http://maven.apache.org&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;properties&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- maven specific properties --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;project.build.sourceEncoding&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&quot;nt&quot;&gt;&amp;lt;/project.build.sourceEncoding&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;samza.version&amp;gt;&lt;/span&gt;0.13.0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/samza.version&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/properties&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependencies&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-api&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-core_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-log4j&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-shell&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;classifier&amp;gt;&lt;/span&gt;dist&lt;span class=&quot;nt&quot;&gt;&amp;lt;/classifier&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;type&amp;gt;&lt;/span&gt;tgz&lt;span class=&quot;nt&quot;&gt;&amp;lt;/type&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-yarn_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-kv_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-kv-rocksdb_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-kafka_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.kafka&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;kafka_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    	&lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.0.0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;slf4j-api&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.6.2&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;slf4j-log4j12&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.6.2&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.json&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;json&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;20171018&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependencies&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;repositories&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;repository&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;my-local-repo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;file://${user.home}/.m2/repository&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;repository&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;apache-releases&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;https://repository.apache.org/content/groups/public&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;repository&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;scala-tools.org&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;Scala-tools Maven2 Repository&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;https://oss.sonatype.org/content/groups/scala-tools&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;repository&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;cloudera-repos&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;Cloudera Repos&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;https://repository.cloudera.com/artifactory/cloudera-repos/&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repositories&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;build&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;plugins&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-compiler-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;3.1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&amp;gt;&lt;/span&gt;1.6&lt;span class=&quot;nt&quot;&gt;&amp;lt;/source&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;target&amp;gt;&lt;/span&gt;1.6&lt;span class=&quot;nt&quot;&gt;&amp;lt;/target&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-assembly-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;2.3&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;descriptors&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;descriptor&amp;gt;&lt;/span&gt;src/main/assembly/src.xml&lt;span class=&quot;nt&quot;&gt;&amp;lt;/descriptor&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;/descriptors&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;make-assembly&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;phase&amp;gt;&lt;/span&gt;package&lt;span class=&quot;nt&quot;&gt;&amp;lt;/phase&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;goals&amp;gt;&lt;/span&gt;
              &lt;span class=&quot;nt&quot;&gt;&amp;lt;goal&amp;gt;&lt;/span&gt;single&lt;span class=&quot;nt&quot;&gt;&amp;lt;/goal&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/goals&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugins&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/build&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/project&amp;gt;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»£ç æ˜¯ç»Ÿè®¡ä¸€ä¸‹å›ºå®šæ—¶é—´æ®µå†…ï¼Œæ¯ä¸ªäººç‚¹å‡»æ€»ç‚¹å‡»æ¬¡æ•°å’Œæ€»æ—¶å»¶ã€‚è¾“å…¥æµdemoä¸ºï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{&quot;timestamp&quot;:&quot;2015-09-01T01:35:19Z&quot;,&quot;url&quot;:&quot;/foo&quot;,&quot;user&quot;:&quot;bob&quot;,&quot;latencyMs&quot;:66}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆ›å»ºä¸€ä¸ªmavenå·¥ç¨‹ï¼Œå·¥ç¨‹çš„ç»“æ„å’Œhello-samzaçš„ç›¸ä¼¼ï¼Œconfigå’Œresourceå¯ä»¥ç§»æ¤è¿‡æ¥ã€‚&lt;/p&gt;

&lt;p&gt;å°†ä¸Šè¿°æ–‡ä»¶åˆ›å»ºå¹¶åŠ å…¥åˆ°ç›¸ä¼¼è·¯å¾„ä¸‹ï¼Œæ‰§è¡Œä¸‹è¿°å‘½ä»¤ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;src_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
mvn clean package
&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;target/target.jar &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;samza_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/lib/
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;samza_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-zcvf&lt;/span&gt; filename.tar.gz &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;filename.tar.gz &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;tmp&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;samza_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/bin/run-job.sh &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--config-factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;org.apache.samza.config.factories.PropertiesConfigFactory &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--config-path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;file://&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;samza_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/config/config.properties
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å·¥ç¨‹è¿è¡Œå®Œæˆã€‚&lt;/p&gt;

&lt;h3 id=&quot;å­¦ä¹ æˆæœ&quot;&gt;å­¦ä¹ æˆæœ&lt;/h3&gt;

&lt;p&gt;ç›®å‰æ¥çœ‹samzaçš„ç”Ÿæ€è¿˜æ¯”è¾ƒå¹´è½»ï¼Œè½åœ°çš„æƒ…å†µè¿˜æ˜¯å¤ªå°‘ï¼Œç”±äºè‡ªå·±çŸ¥è¯†æ ˆçš„ç¼ºå¤±ï¼Œå¯¹äºå¦‚ä½•è‡ªå·±ç¼–å†™ä¸€ä¸ªsamzaçš„ç¨‹åºå­˜åœ¨é—®é¢˜ï¼Œæ¯”å¦‚mavenæ‰“åŒ…ï¼Œç¤ºä¾‹ä»£ç ç›®å‰æ²¡æœ‰æ‹†å¼€è¿è¡Œï¼Œå¯¼è‡´å¯¹äºæ¯ä¸€æ­¥çš„å…³é”®è¾“å‡ºä¸äº†è§£ï¼Œæ•´ä¸ªä»£ç ç¼ºå°‘å¿…è¦ä¿¡æ¯çš„äº†è§£å¿…ç„¶æ˜¯ä¸å¥½è¿›è¡Œä¸‹ä¸€æ­¥å­¦ä¹ çš„ï¼Œç›®å‰æ¥çœ‹éš¾ç‚¹æœ‰äºŒï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;mavenä¸ç†Ÿæ‚‰ã€‚&lt;/li&gt;
  &lt;li&gt;samzaä»£ç ä¿®æ”¹ä¸å®¹æ˜“ï¼Œä¸ä¼šåœ¨å…³é”®ä¿¡æ¯ä¸Šè¿›è¡Œè¾“å‡ºæŸ¥çœ‹ã€‚&lt;/li&gt;
  &lt;li&gt;kafkaè¿™ä¸€å—åŸºæœ¬ä¸æ‡‚ï¼Œæ²¡æœ‰å¼€å‘è¿‡producerå’Œconsumerï¼Œä¸çŸ¥é“åˆ†å¸ƒå¼æ¨¡å¼ä¸‹çš„å·¥ä½œæœºåˆ¶&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œsamzaçš„å­¦ä¹ æˆæœ¬å…¶å®è¿˜æ˜¯æŒºé«˜çš„ï¼Œæ‰€ä»¥è¯´è¿™å‘¨å…ˆæ€»ç»“ï¼Œè®©è€å¸ˆè¯„ä»·ä¸€ä¸‹ï¼Œç„¶åå§stormæ­å»ºå¥½ï¼Œä¸€èµ·è¯„ä¼°ä¸€ä¸‹ï¼Œæœ€åå†³å®šç”¨ä»€ä¹ˆï¼Œæˆ‘è¿˜æ˜¯æ¯”è¾ƒå€¾å‘äºç”¨sparkã€‚&lt;/p&gt;
</description>
        <pubDate>Mon, 20 Nov 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/11/20/Samza%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/11/20/Samza%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        
      </item>
    
      <item>
        <title>Kafkaå­¦ä¹ ç¬”è®°</title>
        <description>&lt;h2 id=&quot;samza&quot;&gt;Samza&lt;/h2&gt;

&lt;h3 id=&quot;ç¬”è®°&quot;&gt;ç¬”è®°ï¼š&lt;/h3&gt;

&lt;p&gt;samzaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æµå¼æ•°æ®å¤„ç†æ¡†æ¶ï¼ˆstreaming processingï¼‰ï¼Œå®ƒæ˜¯åŸºäºKafkaæ¶ˆæ¯é˜Ÿåˆ—æ¥å®ç°ç±»å®æ—¶çš„æµå¼æ•°æ®å¤„ç†çš„ã€‚(å‡†ç¡®çš„è¯´ï¼Œsamzaæ˜¯é€šè¿‡æ¨¡å—åŒ–çš„å½¢å¼æ¥ä½¿ç”¨kafkaçš„ï¼Œå› æ­¤å¯ä»¥æ„æ¶åœ¨å…¶ä»–æ¶ˆæ¯é˜Ÿåˆ—æ¡†æ¶ä¸Šï¼Œä½†å‡ºå‘ç‚¹å’Œé»˜è®¤å®ç°æ˜¯åŸºäºkafka)ã€‚&lt;/p&gt;

&lt;p&gt;kafkaé›†ç¾¤å¦‚æœæœ‰ä¸€ä¸ªå°æœºå™¨æ²¡æœ‰é€šï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯hostçš„é—®é¢˜ã€‚&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kafka-topics.sh &lt;span class=&quot;nt&quot;&gt;--create&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--zookeeper&lt;/span&gt; 192.168.1.xx:2181,192.168.1.xx:2181,192.168.1.xx:2181 &lt;span class=&quot;nt&quot;&gt;--replication-factor&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;--partitions&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;--topic&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kafka-topics.sh &lt;span class=&quot;nt&quot;&gt;--list&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--zookeeper&lt;/span&gt; localhost:2181
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kafka-console-producer.sh &lt;span class=&quot;nt&quot;&gt;--broker-list&lt;/span&gt; 192.168.1.xx:9092,192.168.1.xx:9092,192.168.1.xx:9092 &lt;span class=&quot;nt&quot;&gt;--topic&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kafka-console-consumer.sh &lt;span class=&quot;nt&quot;&gt;--zookeeper&lt;/span&gt; 192.168.1.xx:2181,192.168.1.xx:2181,192.168.1.xx:2181 &lt;span class=&quot;nt&quot;&gt;--from-beginning&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--topic&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;kafka&quot;&gt;kafka&lt;/h3&gt;

&lt;p&gt;Kafka is a distributed,partitioned,replicated commit logserviceã€‚&lt;/p&gt;

&lt;p&gt;kafkaå¯¹æ¶ˆæ¯ä¿å­˜æ—¶æ ¹æ®Topicè¿›è¡Œå½’ç±»ï¼Œå‘é€æ¶ˆæ¯è€…æˆä¸ºProducer,æ¶ˆæ¯æ¥å—è€…æˆä¸ºConsumerã€‚&lt;/p&gt;

&lt;p&gt;kafkaé›†ç¾¤æœ‰å¤šä¸ªkafkaå®ä¾‹ç»„æˆï¼Œæ¯ä¸ªå®ä¾‹serveræˆä¸ºbrokerã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;topicï¼šæ¶ˆæ¯å­˜æ”¾çš„ç›®å½•å³ä¸»é¢˜&lt;/li&gt;
  &lt;li&gt;Producerï¼šç”Ÿäº§æ¶ˆæ¯åˆ°topicçš„ä¸€æ–¹&lt;/li&gt;
  &lt;li&gt;Consumerï¼šè®¢é˜…topicæ¶ˆè´¹æ¶ˆæ¯çš„ä¸€æ–¹&lt;/li&gt;
  &lt;li&gt;Brokerï¼šKafkaçš„æœåŠ¡å®ä¾‹å°±æ˜¯ä¸€ä¸ªbroker&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201409/28/143553z1pif7uok8ezr61u.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªTopicå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç±»æ¶ˆæ¯ï¼Œæ¯ä¸ªtopicå°†è¢«åˆ†æˆå¤šä¸ªpartition(åŒº)ï¼Œæ¯ä¸ªpartitionåœ¨å­˜å‚¨å±‚é¢æ˜¯append logæ–‡ä»¶ï¼Œpartitionåˆ†å¸ƒåœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;æ¶ˆæ¯å‘é€æ—¶éƒ½è¢«å‘é€åˆ°ä¸€ä¸ªtopicï¼Œå…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ªç›®å½•ï¼Œè€Œtopicç”±æ˜¯ç”±ä¸€äº›Partition Logs(åˆ†åŒºæ—¥å¿—)ç»„æˆ,å…¶ç»„ç»‡ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201409/28/143553t3nhnsbri6s6nfh5.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;consumerå¯ä»¥ä½¿ç”¨ä»»æ„é¡ºåºæ¶ˆè´¹æ¶ˆæ¯ï¼Œåªéœ€å°†offseté‡ç½®ä¸ºä»»æ„å€¼ã€‚&lt;/p&gt;

&lt;p&gt;kafkaé›†ç¾¤å‡ ä¹ä¸éœ€è¦ç»´æŠ¤ä»»ä½•consumerå’ŒproducerçŠ¶æ€ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯æœ‰zookeeperä¿å­˜ã€‚&lt;/p&gt;

&lt;p&gt;partitionsçš„è®¾è®¡ç›®çš„æœ‰å¤šä¸ªï¼Œæœ€æ ¹æœ¬åŸå› æ˜¯kafkaåŸºäºæ–‡ä»¶å­˜å‚¨ã€‚&lt;/p&gt;

&lt;p&gt;å°†æ—¥å¿—å†…å®¹åˆ†æ•£åˆ°å¤šä¸ªserverä¸Šï¼Œé¿å…æ–‡ä»¶å°ºå¯¸è¾¾åˆ°å•æœºç£ç›˜çš„ä¸Šé™ã€‚&lt;/p&gt;

&lt;p&gt;æ¯ä¸ªpartitonéƒ½ä¼šè¢«å½“å‰server(kafkaå®ä¾‹)ä¿å­˜ï¼Œå¯ä»¥å°†ä¸€ä¸ªtopicåˆ‡åˆ†å¤šä»»æ„å¤šä¸ªpartitionsï¼Œæ¥æ¶ˆæ¯ä¿å­˜/æ¶ˆè´¹çš„æ•ˆç‡ï¼Œæ­¤å¤–è¶Šå¤šçš„partitionsæ„å‘³ç€å¯ä»¥å®¹çº³æ›´å¤šçš„consumerï¼Œæœ‰æ•ˆæå‡å¹¶å‘æ¶ˆè´¹çš„èƒ½åŠ›ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªTopicçš„å¤šä¸ªpartitionsï¼Œè¢«åˆ†å¸ƒåœ¨kafkaé›†ç¾¤ä¸­çš„å¤šä¸ªserverä¸Šï¼›æ¯ä¸ªserver(kafkaå®ä¾‹)è´Ÿè´£partitionsä¸­æ¶ˆæ¯çš„è¯»å†™æ“ä½œï¼›æ­¤å¤–kafkaè¿˜å¯ä»¥é…ç½®partitionséœ€è¦å¤‡ä»½çš„ä¸ªæ•°(replicas)ï¼Œæ¯ä¸ªpartitionå°†ä¼šè¢«å¤‡ä»½åˆ°å¤šå°æœºå™¨ä¸Š,ä»¥æé«˜å¯ç”¨æ€§ã€‚&lt;/p&gt;

&lt;p&gt;Producersï¼šProducerå°†æ¶ˆæ¯å‘å¸ƒåˆ°æŒ‡å®šçš„Topicä¸­ï¼ŒåŒæ—¶Producerä¹Ÿèƒ½å†³å®šå°†æ­¤æ¶ˆæ¯å½’å±äºå“ªä¸ªpartitionï¼›æ¯”å¦‚åŸºäºâ€round-robinâ€æ–¹å¼æˆ–è€…é€šè¿‡å…¶ä»–çš„ä¸€äº›ç®—æ³•ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;Consumersï¼šæœ¬è´¨ä¸Škafkaåªæ”¯æŒTopicã€‚æ¯ä¸ªconsumerå±äºä¸€ä¸ªconsumer groupï¼›åè¿‡æ¥è¯´,æ¯ä¸ªgroupä¸­å¯ä»¥æœ‰å¤šä¸ªconsumerã€‚å‘é€åˆ°Topicçš„æ¶ˆæ¯ï¼Œåªä¼šè¢«è®¢é˜…æ­¤Topicçš„æ¯ä¸ªgroupä¸­çš„ä¸€ä¸ªconsumeræ¶ˆè´¹ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæ‰€æœ‰çš„consumeréƒ½å…·æœ‰ç›¸åŒçš„groupï¼Œè¿™ç§æƒ…å†µå’Œqueueæ¨¡å¼å¾ˆåƒ;æ¶ˆæ¯å°†ä¼šåœ¨consumersä¹‹é—´è´Ÿè½½å‡è¡¡ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæ‰€æœ‰çš„consumeréƒ½å…·æœ‰ä¸åŒçš„groupï¼Œé‚£è¿™å°±æ˜¯â€å‘å¸ƒ-è®¢é˜…â€;æ¶ˆæ¯å°†ä¼šå¹¿æ’­ç»™æ‰€æœ‰çš„æ¶ˆè´¹è€…ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºä¸€ä¸ªtopicï¼ŒåŒä¸€ä¸ªgroupä¸­ä¸èƒ½æœ‰å¤šäºpartitionsä¸ªæ•°çš„consumeråŒæ—¶æ¶ˆè´¹ï¼Œå¦åˆ™å°†æ„å‘³ç€æŸäº›consumerå°†æ— æ³•å¾—åˆ°æ¶ˆæ¯ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªTopicä¸­çš„æ¯ä¸ªpartionsï¼Œåªä¼šè¢«ä¸€ä¸ªâ€è®¢é˜…è€…â€ä¸­çš„ä¸€ä¸ªconsumeræ¶ˆè´¹ï¼Œä¸è¿‡ä¸€ä¸ªconsumerå¯ä»¥æ¶ˆè´¹å¤šä¸ªpartitionsä¸­çš„æ¶ˆæ¯ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201409/28/143554ypkap9sc5cu2j993.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;â€‹    æœ¬è´¨ä¸Škafkaåªæ”¯æŒTopic.æ¯ä¸ªconsumerå±äºä¸€ä¸ªconsumer group;åè¿‡æ¥è¯´,æ¯ä¸ªgroupä¸­å¯ä»¥æœ‰å¤šä¸ªconsumer.å‘é€åˆ°Topicçš„æ¶ˆæ¯,åªä¼šè¢«è®¢é˜…æ­¤Topicçš„æ¯ä¸ªgroupä¸­çš„ä¸€ä¸ªconsumeræ¶ˆè´¹.&lt;/p&gt;
</description>
        <pubDate>Sun, 19 Nov 2017 20:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/11/19/Kafka%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/11/19/Kafka%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        <category>åˆ†å¸ƒå¼</category>
        
        <category>æ¡†æ¶</category>
        
        
      </item>
    
  </channel>
</rss>
